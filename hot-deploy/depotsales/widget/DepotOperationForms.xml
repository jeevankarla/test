<?xml version="1.0" encoding="UTF-8"?>
<forms xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
        xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/widget-form.xsd">
<form name="FindDepotTransPurchaseOrder" title="" type="single" target="${targetRequest}" header-row-style="header-row" default-table-style="basic-table">
        <field name="salesChannelEnumId" ><hidden value="${ChannalType}"/></field>
        <field name="hideSearch"><hidden value="Y"/></field>
        <field name="partyId" title="Branch">
           <drop-down allow-empty="true">
               <list-options key-name="payToPartyId" list-name="branchList" description="${storeName}"/>
           </drop-down>
        </field>
        <field name="orderTypeId">
           <drop-down no-current-selected-key="PURCHASE_ORDER">
              <entity-options description="${description}" entity-name="OrderType" key-field-name="orderTypeId">
                 <entity-constraint name="parentTypeId" operator="like" value="%PURCHASE%"/>
              </entity-options>
           </drop-down>
        </field>
        <field title="Delivery Date" name="estimatedDeliveryDate"><date-find/></field>
        <field name="orderId"><text-find/></field>
        <field title="Entry Date" name="entryDate"><date-find/></field>
        <field name="orderNo" title="sequenceId"><text-find/></field>
        <field name="refrenceNo" title="PORef.No"><text-find/></field>
<!--        <field name="productId"><lookup target-form-name="LookupProduct"/></field> -->
        <!-- <field name="orderTypeId"><hidden value="PURCHASE_ORDER"/></field> -->
        <field name="statusId">
	        	<drop-down allow-empty="true">
	        		<option key="ORDER_CREATED" description="Created"/>
	        		<option key="ORDER_APPROVED" description="Approved"/>
	        		<option key="ORDER_CANCELLED" description="Cancelled"/>
	        		<option key="ORDER_SUSPENDED" description="Suspended"/>
	        	</drop-down>
        </field>
<!--         <field name="roleTypeId"><hidden value="SUPPLIER_AGENT"/></field> -->
         <field name="purposeTypeId"><hidden value="DEPOT_PURCHASE"/></field> 
         <field name="findPoFlag"><hidden value="Y"/></field>  
    	<field name="supplierId" title="Supplier"><lookup target-form-name="SupplierLookupPartyName" target-parameter="roleTypeId"/></field>
        <field name="noConditionFind"><hidden value="Y"/><!-- if this isn't there then with all fields empty no query will be done --></field>
        <field name="submitButton" title="${uiLabelMap.CommonFind}" widget-style="smallSubmit"><submit button-type="button"/></field>
    </form>
     <form name="listDepotTransPurchaseOrders" type="list" list-name="listIt" paginate-target="${targetRequest}"
        odd-row-style="alternate-row" header-row-style="header-row-2" default-table-style="basic-table hover-bar">
        <actions>
           
        </actions>
      	<row-actions>
      		<entity-condition entity-name="OrderItem" list="orderItemList" >
      			<condition-expr field-name="orderId" operator="equals" value="${orderId}" />
      		</entity-condition>
      		<script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/POSearchFilter.groovy"/>
      		<set field="newSize" value="${orderItemsSize}" />
      		<set field="size" value="${groovy: return(orderItemList.size())}"/>
      		<entity-condition entity-name="OrderAttribute" list="orderAttributes" >
      			<condition-expr field-name="orderId" operator="equals" value="${orderId}" />
      		</entity-condition>
      		<set field="poRefNum" value="${groovy: return(orderAttributes[0].attrValue)}"/>
      		<!-- <entity-condition entity-name="SupplierProduct" list="SupplierProductList" >
      			<condition-expr field-name="productId" operator="equals" value="${orderItemList[0].productId}"/>
      		</entity-condition>
      		<set field="partyId" value="${orderRoles[0].partyId}" />
      		<entity-condition entity-name="ShipmentReceipt" list="ShipmentReceiptList" >
      			<condition-list combine="and" >
	      			<condition-expr field-name="orderId" operator="equals" value="${orderId}" />
	      			<condition-expr field-name="statusId" operator="not-equals" value="SR_REJECTED" />
      			</condition-list>
      		</entity-condition>
      		<set field="flag" value="${groovy: return (ShipmentReceiptList.size() > 0)? 'Y' : 'N';}"/>
      		<entity-condition entity-name="Shipment" list="ShipmentList" >
      			<condition-list combine="and" >
	      			<condition-expr field-name="primaryOrderId" operator="equals" value="${orderId}" />
      			</condition-list>
      		</entity-condition>
      		<set field="vehicleId" value="${ShipmentList[0].vehicleId}"/> -->
      		<entity-condition entity-name="Shipment" list="ShipmentList" >
      			<condition-expr field-name="primaryOrderId" operator="equals" value="${orderId}"/>
      		</entity-condition>
      		<set field="shipmentDone" value="${groovy: return (ShipmentList.size() > 0)? 'Y' : 'N';}"/>
      		<entity-condition entity-name="OrderRole" list="orderRoleList" >
	      		<condition-list combine="and" >
    	  			<condition-expr field-name="orderId" operator="equals" value="${orderId}" />
	      			<condition-expr field-name="roleTypeId" operator="equals" value="SUPPLIER_AGENT" />
      			</condition-list>
      		</entity-condition>
      		<set field="supplierPartyId" value="${groovy: return(orderRoleList[0].partyId)}"/>
      		<set field="boFlag" value="${groovy: if(grandTotal &lt;= 200000) return 'Y'; else return 'N';}"/>
      		<set field="roFlag" value="${groovy: if((grandTotal &gt;= 200000) &amp;&amp; (grandTotal &lt;= 5000000)) return 'Y'; else return 'N';}"/>
      		<set field="hoFlag" value="${groovy: if((grandTotal &gt;= 5000000) &amp;&amp; (grandTotal &lt;= 10000000)) return 'Y'; else return 'N';}"/>
      		<set field="mdFlag" value="${groovy: if(grandTotal &gt; 10000000) return 'Y'; else return 'N';}"/>
      	</row-actions>
      	<field name="orderId" widget-style="buttontext">
      		<hyperlink target="POoverview" description="${groovy: if(orderNo !=null) return orderNo; else return orderId;}" target-window="_blank">
      			<parameter param-name="orderId"/>
      		</hyperlink>
      	</field>
      	<field name="productStoreId" title="Branch"><display></display></field>
        <field name="entryDate" title="Entry Date"><display description="${groovy:org.ofbiz.base.util.UtilDateTime.toDateString(entryDate, &quot;dd/MM/yyyy&quot;);}"/></field>
        <field name="createdBy" title="Created By"><display/></field>
        <!-- <field name="salesChannelEnumId"><display/></field> -->
        <field name="supplierPartyId" title="Supplier"><display description="${groovy:org.ofbiz.party.party.PartyHelper.getPartyName(delegator, supplierPartyId, false);} - [${supplierPartyId}]"/></field>
         <!-- <field use-when="&quot;${orderTypeId}&quot; == &quot;LETTER_OF_INTENT&quot;" name="poReport" widget-style="buttontext">
            <hyperlink target="LetterOfIndentReport.pdf" description="Report" target-window="_blank">
                <parameter param-name="orderId"/>
            </hyperlink>
        </field> -->
        <field name="poRefNum" title="poRef. No"><display/></field>
        <field use-when="&quot;${orderTypeId}&quot; != &quot;LETTER_OF_INTENT&quot; &amp;&amp; &quot;${orderTypeId}&quot; != &quot;ARC_ORDER&quot;" name="poReport" widget-style="buttontext">
            <hyperlink target="PurchaseOrderViewDEPOT.pdf" description="Report" target-window="_blank">
                <parameter param-name="orderId"/>
            </hyperlink>
        </field>
        <!--  <field use-when="&quot;${orderTypeId}&quot; == &quot;ARC_ORDER&quot;" name="arcReport" widget-style="buttontext">
            <hyperlink target="arcOrder.pdf" description="Report" target-window="_blank">
                <parameter param-name="orderId"/>
            </hyperlink>
        </field>
         -->
        
       <field name="editOrder" widget-style="buttontext" use-when="statusId.equals(&quot;ORDER_CREATED&quot;) &amp;&amp;${groovy:((security.hasEntityPermission(&quot;DEPOTSALES&quot;, &quot;_EDIT_PO&quot;, session)))}" >
            <hyperlink target="editMaterialDepotTransPO" description="Edit Order">
                 <parameter param-name="orderId"/>
            </hyperlink>
        </field>
        <field name="approveOrder"  title="P And S Approvals" widget-style="buttontext" use-when="statusId.equals(&quot;ORDER_CREATED&quot;)&amp;&amp;${groovy:((security.hasEntityPermission(&quot;DEPOTSALES&quot;, &quot;_APPROVE_PO&quot;, session)))}" >
            <hyperlink target="approvalLevelOfDepotPo" description="Commercial Head">
                <parameter param-name="orderId"/>
                <parameter param-name="statusId" value="APPROVE_LEVEL1" />
            </hyperlink>
        </field>
        <field use-when="&quot;${orderTypeId}&quot; != &quot;LETTER_OF_INTENT&quot; &amp;&amp; &quot;${orderTypeId}&quot; != &quot;ARC_ORDER&quot;" name="Minutes" widget-style="buttontext">
            <hyperlink target="PurchaseOrderMinutesReport.pdf" description="Minutes" target-window="_blank">
                <parameter param-name="orderId"/>
            </hyperlink>
        </field>
        <field name="approveOrder" title="P And S Approvals" widget-style="buttontext" use-when="statusId.equals(&quot;APPROVE_LEVEL1&quot;)&amp;&amp;${groovy:((security.hasEntityPermission(&quot;DEPOTSALES&quot;, &quot;_APPROVE_PO&quot;, session)))}" >
            <hyperlink target="approvalLevelOfDepotPo" description="Account Head">
                <parameter param-name="orderId"/>
                <parameter param-name="statusId" value="APPROVE_LEVEL2" />
            </hyperlink>
        </field> 
        <field name="approveOrder" title="P And S Approvals" widget-style="buttontext" use-when="statusId.equals(&quot;APPROVE_LEVEL2&quot;)&amp;&amp;${groovy:((security.hasEntityPermission(&quot;DEPOTSALES&quot;, &quot;_APPROVE_PO&quot;, session)))}" >
            <hyperlink target="approvalLevelOfDepotPo" description="Regional Head">
                <parameter param-name="orderId"/>
                <parameter param-name="statusId" value="APPROVE_LEVEL3" />
            </hyperlink>
        </field> 
        <field name="approveOrder" title="P And S Approvals" widget-style="buttontext" use-when="statusId.equals(&quot;APPROVE_LEVEL3&quot;) || statusId.equals(&quot;ORDER_APPROVED&quot;) || statusId.equals(&quot;ORDER_COMPLETED&quot;)" ><display description="P And S Approved" /></field> 
        <field name="boapprove" title="Approve" widget-style="buttontext" use-when="statusId.equals(&quot;APPROVE_LEVEL3&quot;)&amp;&amp;boFlag.equals(&quot;Y&quot;)&amp;&amp;${groovy:((security.hasEntityPermission(&quot;DEPOTSALES&quot;, &quot;_APPROVE_PO&quot;, session)))}" >
            <hyperlink target="approvalLevelOfDepotPo" description="BO Credit Approve">
                <parameter param-name="orderId"/>
                <parameter param-name="statusId" value="ORDER_APPROVED" />
            </hyperlink>
        </field>  
       <field name="boapprove" title="Approve" widget-style="buttontext" use-when="statusId.equals(&quot;APPROVE_LEVEL3&quot;)&amp;&amp;roFlag.equals(&quot;Y&quot;)&amp;&amp;${groovy:((security.hasEntityPermission(&quot;DEPOTSALES&quot;, &quot;_APPROVE_PO&quot;, session)))}" >
            <hyperlink target="approvalLevelOfDepotPo" description="RO Credit Approve">
                <parameter param-name="orderId"/>
                <parameter param-name="statusId" value="ORDER_APPROVED" />
            </hyperlink>
        </field>
         <field name="boapprove" title="Approve" widget-style="buttontext" use-when="statusId.equals(&quot;APPROVE_LEVEL3&quot;)&amp;&amp;hoFlag.equals(&quot;Y&quot;)&amp;&amp;${groovy:((security.hasEntityPermission(&quot;DEPOTSALES&quot;, &quot;_APPROVE_PO&quot;, session)))}" >
            <hyperlink target="approvalLevelOfDepotPo" description="HO Credit Approve">
                <parameter param-name="orderId"/>
                <parameter param-name="statusId" value="ORDER_APPROVED" />
            </hyperlink>
        </field> 
         <field name="boapprove" title="Approve" widget-style="buttontext" use-when="statusId.equals(&quot;APPROVE_LEVEL3&quot;)&amp;&amp;mdFlag.equals(&quot;Y&quot;)&amp;&amp;${groovy:((security.hasEntityPermission(&quot;DEPOTSALES&quot;, &quot;_APPROVE_PO&quot;, session)))}" >
            <hyperlink target="approvalLevelOfDepotPo" description="HO Credit Approve">
                <parameter param-name="orderId"/>
                <parameter param-name="statusId" value="ORDER_APPROVED" />
            </hyperlink>
        </field>  
      <!-- 	<field name="ApproveOrder" widget-style="buttontext" use-when="statusId.equals(&quot;ORDER_CREATED&quot;)&amp;&amp;${groovy:((security.hasEntityPermission(&quot;DEPOTSALES&quot;, &quot;_APPROVE_PO&quot;, session)))}" >
            <hyperlink target="ApproveDepotPurchaseOrderWithEmail" description="Approve">
                <parameter param-name="orderId"/>
                <parameter param-name="statusId" value="ORDER_APPROVED" />
                <parameter param-name="setItemStatus" value="Y" />
                 <parameter param-name="roleTypeId"  />
            </hyperlink>
        </field>  -->
        <field name="boapprove" title="Approve" widget-style="buttontext" use-when="statusId.equals(&quot;ORDER_APPROVED&quot;)" ><display description="Order Approved" /></field>
        <field name="boapprove" title="Approve" widget-style="buttontext" use-when="statusId.equals(&quot;ORDER_COMPLETED&quot;)" ><display description="Order Completed" /></field>
        <field name="boapprove" title="Approve" widget-style="buttontext" use-when="statusId.equals(&quot;ORDER_CANCELLED&quot;)" ><display description="Order Cancelled" /></field>
        <!-- <field name="SuspendedOrder" use-when="statusId.equals(&quot;ORDER_SUSPENDED&quot;)" ><display description="Order Suspended" /></field> -->
        <field name="cancelOrder" widget-style="buttontext" use-when="(shipmentDone.equals(&quot;N&quot;) &amp;&amp; statusId.equals(&quot;ORDER_APPROVED&quot;)) || statusId.equals(&quot;ORDER_CREATED&quot;) || (statusId.equals(&quot;APPROVE_LEVEL1&quot;)) || (statusId.equals(&quot;APPROVE_LEVEL2&quot;)) || (statusId.equals(&quot;APPROVE_LEVEL3&quot;))&amp;&amp;${groovy:((security.hasEntityPermission(&quot;DEPOTSALES&quot;, &quot;_CANCEL_PO&quot;, session)))}" >
            <hyperlink target="CancelDepotTransPOOrder" description="Cancel Order" confirmation-message="Are you sure to Cancel Order..?">
                 <parameter param-name="orderId"/>
                <parameter param-name="statusId" value="ORDER_CANCELLED" />
                <parameter param-name="setItemStatus" value="Y" />
                <parameter param-name="roleTypeId"/>
            </hyperlink>
        </field> 
        <!-- <field use-when="(flag == &quot;N&quot;)&amp;&amp;((&quot;${statusId}&quot;!=&quot;ORDER_CANCELLED&quot;)&amp;&amp;(&quot;${statusId}&quot;!=&quot;ORDER_COMPLETED&quot;)&amp;&amp;(&quot;${statusId}&quot;!=&quot;ORDER_CREATED&quot;))"  name="raiseGRN" title="Raise GRN" widget-style="buttontext" > -->
       <!--  <field use-when="(&quot;${newSize}&quot;!=&quot;${size}&quot;)&amp;&amp;((&quot;${statusId}&quot;!=&quot;ORDER_CANCELLED&quot;)&amp;&amp;(&quot;${statusId}&quot;!=&quot;ORDER_COMPLETED&quot;)&amp;&amp;(&quot;${statusId}&quot;!=&quot;ORDER_CREATED&quot;)&amp;&amp;(&quot;${statusId}&quot;!=&quot;ORDER_SUSPENDED&quot;)) &amp;&amp;${groovy:((security.hasEntityPermission(&quot;DEPOTSALES&quot;, &quot;_RAISE_GRN&quot;, session)))}"  name="raiseGRN" title="Raise GRN" widget-style="buttontext" >	 <hyperlink target="raiseDepotTransGRN" description="Raise GRN">
        	 	<parameter param-name="orderId"/>
        	 	<parameter param-name="vehicleId"/>
            </hyperlink>
         </field> -->
    </form>
    <form name="FindDepotTransOrder" title="" type="single" target="ProcessOrdersSuppliersDepotTrans" header-row-style="header-row" default-table-style="basic-table">
        <field name="salesChannelEnumId" ><hidden value="DEPOT_CHANNEL"/></field>  
        <!-- <field name="orderTypeId">
           <drop-down no-current-selected-key="SALES_ORDER">
              <entity-options description="${description}" entity-name="OrderType" key-field-name="orderTypeId">
                 <entity-constraint name="parentTypeId" operator="like" value="%SALES%"/>
              </entity-options>
           </drop-down>
        </field> -->
        <field name="orderId"><text/></field>
        <field title="Delivery Date" name="estimatedDeliveryDate"><date-time/></field>
        
        <!-- <field name="sequenceId"><text-find/></field> -->
      <!--  <field name="productId"><lookup target-form-name="LookupProduct"/></field> -->
        <!-- <field name="orderTypeId"><hidden value="PURCHASE_ORDER"/></field> -->
        <field name="statusId">
	        	<drop-down allow-empty="true">
	        		<option key="ORDER_CREATED" description="Created"/>
	        		<option key="ORDER_APPROVED" description="Approved"/>
	        		<option key="ORDER_CANCELLED" description="Cancelled"/>
	        		<option key="ORDER_SUSPENDED" description="Suspended"/>
	        	</drop-down>
        </field>
         <field name="findPoFlag"><hidden value="Y"/></field>  
     	<field name="partyId" title="${uiLabelMap.Customer}"><lookup target-form-name="LookupPartyName"/></field> 
        <field name="noConditionFind"><hidden value="Y"/><!-- if this isn't there then with all fields empty no query will be done --></field>
        <field name="submitButton" title="${uiLabelMap.CommonFind}" widget-style="smallSubmit"><submit button-type="button"/></field>
    </form>
<!--     <form name="FindSalesIndentPayment" title="" type="single" target="${targetRequest}" header-row-style="header-row" default-table-style="basic-table">
        <field name="salesChannelEnumId" ><hidden value="DEPOT_CHANNEL"/></field>  
        <field name="orderId"><text default-value="${parameters.orderId}"/></field>
        <field title="Delivery Date" name="estimatedDeliveryDate"><date-time/></field>
        <field name="statusId">
	        	<drop-down allow-empty="true">
	        		<option key="ORDER_CREATED" description="Created"/>
	        		<option key="ORDER_APPROVED" description="Approved"/>
	        		<option key="ORDER_CANCELLED" description="Cancelled"/>
	        		<option key="ORDER_SUSPENDED" description="Suspended"/>
	        	</drop-down>
        </field>
         <field name="findPoFlag"><hidden value="Y"/></field>  
     	<field name="partyId" title="${uiLabelMap.Customer}"><lookup target-form-name="LookupPartyName"/></field> 
        <field name="noConditionFind"><hidden value="Y"/>if this isn't there then with all fields empty no query will be done</field>
        <field name="submitButton" title="${uiLabelMap.CommonFind}" widget-style="smallSubmit"><submit button-type="button"/></field>
    </form> -->
    
     <form name="FindSalesIndentPayment" title="" type="single" target="${targetRequest}" header-row-style="header-row" default-table-style="basic-table">
        <field name="salesChannelEnumId" ><hidden value="WEB_SALES_CHANNEL"/></field>  
        <!-- <field name="orderTypeId">
           <drop-down no-current-selected-key="SALES_ORDER">
              <entity-options description="${description}" entity-name="OrderType" key-field-name="orderTypeId">
                 <entity-constraint name="parentTypeId" operator="like" value="%SALES%"/>
              </entity-options>
           </drop-down>
        </field> -->
        <field name="partyId" title="${uiLabelMap.Customer}"><lookup target-form-name="LookupPartyName"/></field> 
        <field name="branchId" title="${uiLabelMap.Branch}">
             <drop-down allow-empty="true">
                  <list-options key-name="payToPartyId" list-name="formatList" description="${productStoreName}"/>
              </drop-down>
        </field>
        <field name="orderId" title="${uiLabelMap.IndentId}"><text/></field>
        <field name="orderNo" title="sequenceId"><text-find/></field>
        <field title="${uiLabelMap.IndentDate}" name="estimatedDeliveryDate"><date-time/></field>
        
        <!-- <field name="sequenceId"><text-find/></field> -->
      <!--  <field name="productId"><lookup target-form-name="LookupProduct"/></field> -->
        <!-- <field name="orderTypeId"><hidden value="PURCHASE_ORDER"/></field> -->
        <field name="statusId">
	        	<drop-down allow-empty="true">
	        		<option key="ORDER_CREATED" description="Created"/>
	        		<option key="ORDER_APPROVED" description="Approved"/>
	        		<option key="ORDER_CANCELLED" description="Cancelled"/>
	        		<option key="ORDER_SUSPENDED" description="Suspended"/>
	        	</drop-down>
        </field>
        <field name="findPoFlag"><hidden value="Y"/></field>  
		<field name="noConditionFind"><hidden value="Y"/><!-- if this isn't there then with all fields empty no query will be done --></field>
        <field name="submitButton" title="${uiLabelMap.CommonFind}" widget-style="smallSubmit"><submit button-type="button"/></field>
    </form>
    
     <form name="listSupplierPurchaseOrders" type="list" list-name="listIt" paginate-target="${targetRequest}"
        odd-row-style="alternate-row" header-row-style="header-row-2" default-table-style="basic-table hover-bar">
      	<row-actions>
      		<entity-condition entity-name="OrderItem" list="orderItemList" >
      			<condition-expr field-name="orderId" operator="equals" value="${orderId}" />
      		</entity-condition>
      		<entity-condition entity-name="OrderRole" list="orderRoleList" >
      			<condition-list>
      			<condition-expr field-name="orderId" operator="equals" value="${orderId}" />
      			<condition-expr field-name="roleTypeId" operator="equals" value="SHIP_TO_CUSTOMER"/>
      			</condition-list>
      		</entity-condition>
      		<entity-condition entity-name="OrderRole" list="orderSuppRoleList" >
      			<condition-list>
      			<condition-expr field-name="orderId" operator="equals" value="${orderId}" />
      			<condition-expr field-name="roleTypeId" operator="equals" value="SUPPLIER_AGENT"/>
      			</condition-list>
      		</entity-condition>
      		<entity-condition entity-name="OrderAssoc" list="orderAssocList" >
      			<condition-expr field-name="orderId" operator="equals" value="${orderId}" />
      		</entity-condition>
      		<set field="toOrderId" value="${groovy: return(orderAssocList[0].toOrderId)}"/>
      		<entity-one value-field="orderHeader" entity-name="OrderHeader">
				<field-map field-name="orderId" from-field="toOrderId"/>
			</entity-one>
			<set field="tallyRefNo" from-field="orderHeader.tallyRefNo"/>
      		<script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/supplierPOSearchFilter.groovy"/>
      		<set field="newSize" value="${orderItemsSize}" />
      		      		<set field="newSize" value="${orderItemsSize}" />
      		
      		<set field="size" value="${groovy: return(orderItemList.size())}"/>
      		
      	</row-actions>
      	<field name="orderId" widget-style="buttontext">
      		<hyperlink target="SupplierPoOverView" description="${groovy: if(orderNo !=null) return orderNo; else return orderId;}" target-window="_blank">
      			<parameter param-name="orderId"/>
      		</hyperlink>
      	</field>
      <!-- 	<field name="orderItemSeqId"><display></display></field> -->
        <field name="entryDate" title="Entry Date"><display description="${groovy:org.ofbiz.base.util.UtilDateTime.toDateString(entryDate, &quot;dd/MM/yyyy&quot;);}"/></field>
        <!-- <field name="createdBy" title="Created By"><display/></field> -->
        <!-- <field name="salesChannelEnumId"><display/></field> -->
        <field name="partyId" title="Supplier"><display description="${groovy:org.ofbiz.party.party.PartyHelper.getPartyName(delegator, orderSuppRoleList[0].partyId, false);} - [${orderSuppRoleList[0].partyId}]"/></field>
        <field name="customerId" title="Agency"><display description="${groovy:org.ofbiz.party.party.PartyHelper.getPartyName(delegator, orderRoleList[0].partyId, false);} - [${orderRoleList[0].partyId}]"/></field>

       <!--  <field use-when="&quot;${orderTypeId}&quot; == &quot;LETTER_OF_INTENT&quot;" name="poReport" widget-style="buttontext">
            <hyperlink target="LetterOfIndentReport.pdf" description="Report" target-window="_blank">
                <parameter param-name="orderId"/>
            </hyperlink>
        </field> -->
      <!--   <field use-when="&quot;${orderTypeId}&quot; != &quot;LETTER_OF_INTENT&quot; &amp;&amp; &quot;${orderTypeId}&quot; != &quot;ARC_ORDER&quot;" name="poReport" widget-style="buttontext">
            <hyperlink target="PurchaseOrderView.pdf" description="Report" target-window="_blank">
                <parameter param-name="orderId"/>
            </hyperlink>
        </field>
         <field use-when="&quot;${orderTypeId}&quot; == &quot;ARC_ORDER&quot;" name="arcReport" widget-style="buttontext">
            <hyperlink target="arcOrder.pdf" description="Report" target-window="_blank">
                <parameter param-name="orderId"/>
            </hyperlink>
        </field> -->
        
        
     <!--   <field name="editOrder" widget-style="buttontext" use-when="statusId.equals(&quot;ORDER_CREATED&quot;) &amp;&amp;${groovy:((security.hasEntityPermission(&quot;MM&quot;, &quot;_EDIT_PO&quot;, session)))}" >
            <hyperlink target="editMaterialPO" description="Edit Order">
                 <parameter param-name="orderId"/>
            </hyperlink>
        </field>   -->
      <!-- 	<field name="ApproveOrder" widget-style="buttontext" use-when="statusId.equals(&quot;ORDER_CREATED&quot;)&amp;&amp;${groovy:((security.hasEntityPermission(&quot;MM&quot;, &quot;_APPROVE_PO&quot;, session)))}" >
            <hyperlink target="ApproveOrder" description="Approve">
                <parameter param-name="orderId"/>
                <parameter param-name="statusId" value="ORDER_APPROVED" />
                <parameter param-name="setItemStatus" value="Y" />
                 <parameter param-name="roleTypeId"  />
            </hyperlink>
        </field>  -->        
        <field name="tallyRefNo" title="TallyRefNo"><display/></field>
        <field name="ApproveOrder" widget-style="buttontext" use-when="statusId.equals(&quot;ORDER_APPROVED&quot;)" ><display description="Order Approved" /></field>
        <field name="ApproveOrder" widget-style="buttontext" use-when="statusId.equals(&quot;ORDER_COMPLETED&quot;)" ><display description="Order Completed" /></field>
        <field name="ApproveOrder" title="Order Status" widget-style="buttontext" use-when="statusId.equals(&quot;ORDER_CANCELLED&quot;)" ><display description="Order Cancelled" /></field>
        <!-- <field name="SuspendedOrder" use-when="statusId.equals(&quot;ORDER_SUSPENDED&quot;)" ><display description="Order Suspended" /></field> -->
        <!-- <field name="cancelOrder" widget-style="buttontext" use-when="statusId.equals(&quot;ORDER_CREATED&quot;) &amp;&amp;${groovy:((security.hasEntityPermission(&quot;MM&quot;, &quot;_CANCEL_PO&quot;, session)))}" >
            <hyperlink target="CancelOrder" description="Cancel Order" confirmation-message="Are you sure to Cancel Order..?">
                 <parameter param-name="orderId"/>
                <parameter param-name="statusId" value="ORDER_CANCELLED" />
                <parameter param-name="setItemStatus" value="Y" />
                <parameter param-name="roleTypeId"/>
            </hyperlink>
        </field>  -->
       <!--  <field  title="Email Po Report " use-when="statusId.equals(&quot;ORDER_APPROVED&quot;) &amp;&amp; ${groovy:((security.hasEntityPermission(&quot;MM&quot;, &quot;_PORPT_EMAIL&quot;,session)))}"  name="Send Email" widget-style="buttontext">
             <hyperlink target-type="plain" target="javascript:showPoReportEmail('${partyId}','${orderId}');" description="Send Email">
            </hyperlink>
      </field> -->
        <!-- <field use-when="(flag == &quot;N&quot;)&amp;&amp;((&quot;${statusId}&quot;!=&quot;ORDER_CANCELLED&quot;)&amp;&amp;(&quot;${statusId}&quot;!=&quot;ORDER_COMPLETED&quot;)&amp;&amp;(&quot;${statusId}&quot;!=&quot;ORDER_CREATED&quot;))"  name="raiseGRN" title="Raise GRN" widget-style="buttontext" > -->
        <field use-when="(&quot;${newSize}&quot;!=&quot;${size}&quot;)&amp;&amp;((&quot;${statusId}&quot;!=&quot;ORDER_CANCELLED&quot;)&amp;&amp;(&quot;${statusId}&quot;!=&quot;ORDER_COMPLETED&quot;)&amp;&amp;(&quot;${statusId}&quot;!=&quot;ORDER_CREATED&quot;)&amp;&amp;(&quot;${statusId}&quot;!=&quot;ORDER_SUSPENDED&quot;)) &amp;&amp;${groovy:((security.hasEntityPermission(&quot;MM&quot;, &quot;_RAISE_GRN&quot;, session)))}"  name="raiseGRN" title="Dispatch Goods" widget-style="buttontext" >	 <hyperlink target="raiseDepotTransGRN" description="Dispatch Goods">
        	 	<parameter param-name="orderId"/>
        	 	<parameter param-name="orderNo"/>
        	 	<!-- <parameter param-name="vehicleId"/> -->
            </hyperlink>
         </field>
    </form>
     <form name="ListSupplierShipments" type="list" list-name="listIt" paginate-target="${targetRequest}"
        odd-row-style="alternate-row" header-row-style="header-row-2" default-table-style="basic-table hover-bar">
        <actions>
        </actions>
        <row-actions>
        	<entity-condition entity-name="Invoice" list="invoices">
        		<condition-list combine="and">
        			<condition-expr field-name="shipmentId" from-field="shipmentId"/>
        			<condition-expr field-name="statusId" operator="not-equals" value="INVOICE_CANCELLED"/>
        		</condition-list>
        	</entity-condition>
        	<set field="invSize" value="${groovy: invoices.size();}"/>
        	<entity-condition entity-name="ShipmentReceipt" list="shipmentReceiptList">
        		<condition-list combine="and">
        			<condition-expr field-name="shipmentId" from-field="shipmentId" />
        			<condition-expr field-name="statusId" operator="equals" value="SR_RECEIVED"/>
        		</condition-list>
        	</entity-condition>
        	<set field="shipmentReceiptSize" value="${groovy: shipmentReceiptList.size();}"/>
        	<entity-condition entity-name="ShipmentReceipt" list="invoiceReceiptList">
        		<condition-list combine="and">
        			<condition-expr field-name="shipmentId" from-field="shipmentId" />
        			<condition-expr field-name="statusId" operator="equals" value="SR_ACCEPTED"/>
        		</condition-list>
        	</entity-condition>
        	<set field="invoiceReceiptSize" value="${groovy: invoiceReceiptList.size();}"/>
        </row-actions>
      	<field name="shipmentId" widget-style="buttontext h3" title="Shipment Id">
      		<hyperlink target="SupplierShipmentOverview" description="${shipmentId}" target-window="_blank" >
                <parameter param-name="shipmentId"/>
            </hyperlink>
      	</field>
        <field name="estimatedShipDate" title="GRN Ship Date"><display description="${groovy:org.ofbiz.base.util.UtilDateTime.toDateString(estimatedShipDate, &quot;dd MMMMM, yyyy&quot;);}"/></field>
        <field name="salesOrder" title="PO No" widget-style="buttontext"><display></display>
        	<!-- <hyperlink target="POoverview" description="${primaryOrderId}" target-window="_blank">
      			<parameter param-name="orderId" value="${primaryOrderId}"/>
      		</hyperlink> -->
        </field>
        <field name="partyId">
        <display-entity entity-name="PartyNameView" key-field-name="partyId" description="${firstName} ${middleName} ${lastName} ${groupName}-[${partyId}]">
               <!--  <sub-hyperlink description="[${partyId}]" target="/partymgr/control/viewprofile" target-type="inter-app">
                    <parameter param-name="partyId" from-field="partyId"/>
                </sub-hyperlink> -->
            </display-entity>
        </field>
<!--         <field name="vehicleId" title="Vehicle No"><display/></field> -->
        <field name="statusId" title="Status">
        	<display-entity entity-name="StatusItem" description="${description}"/>
        </field>
        <field name="editGRN" widget-style="buttontext" title="Edit GRN" use-when="(&quot;${invSize}&quot; == &quot;0&quot;)&amp;&amp;(invoiceReceiptSize.equals(&quot;0&quot;))&amp;&amp;(!statusId.equals(&quot;SHIPMENT_CANCELLED&quot;))&amp;&amp; ${groovy:((security.hasEntityPermission(&quot;DEPOTSALES&quot;, &quot;_RAISE_GRN&quot;, session)))}">
            <hyperlink target="editGRN" description="Edit GRN">
                <parameter param-name="shipmentId"/>
                <parameter param-name="orderId" value="${primaryOrderId}"/>
                <parameter param-name="orderNo" from-field="salesOrder"/>
            </hyperlink>
        </field>
        <field name="cancelGRN" widget-style="buttontext" title="Cancel GRN" use-when="(&quot;${invSize}&quot; == &quot;0&quot;)&amp;&amp;(invoiceReceiptSize.equals(&quot;0&quot;))&amp;&amp;(!statusId.equals(&quot;SHIPMENT_CANCELLED&quot;))&amp;&amp; ${groovy:((security.hasEntityPermission(&quot;DEPOTSALES&quot;, &quot;_RAISE_GRN&quot;, session)))}">
            <hyperlink target="CancelGrnShipment" description="Cancel GRN">
                <parameter param-name="shipmentId"/>
            </hyperlink>
        </field>
        <field name="report" widget-style="buttontext"  use-when="(!statusId.equals(&quot;SHIPMENT_CANCELLED&quot;))">
            <hyperlink target="MRRreportDepotSales.pdf" description="Report" target-window="_blank">
             	<parameter param-name="shipmentId" value="${shipmentId}"/>
             	<parameter param-name="orderId" value="${primaryOrderId}"/>
               	<parameter param-name="datetimeReceived" value="${groovy:org.ofbiz.base.util.UtilDateTime.toDateString(estimatedShipDate, &quot;dd-MMM-yyyy&quot;);}"/>
            </hyperlink>
        </field>
         <field name="addContent" title="Content" widget-style="buttontext" use-when="true">
           <hyperlink target-type="plain" description="Add Content" target="javascript:addContent('${shipmentId}','${primaryOrderId}');"></hyperlink>
        </field>
       <!--  <field name="raiseInvoice" widget-style="buttontext" title="Raise Invoice" use-when="(&quot;${invSize}&quot; == &quot;0&quot;)&amp;&amp;(!invoiceReceiptSize.equals(&quot;0&quot;))&amp;&amp;(!statusId.equals(&quot;SHIPMENT_CANCELLED&quot;))&amp;&amp;${groovy:((security.hasEntityPermission(&quot;DEPOTSALES&quot;, &quot;_RAISE_INVOICE&quot;, session)))}">
            <hyperlink target="MaterialInvoiceInit" description="Invoice">
                <parameter param-name="shipmentId"/>
            </hyperlink>
        </field>  -->
    </form>
    </forms>