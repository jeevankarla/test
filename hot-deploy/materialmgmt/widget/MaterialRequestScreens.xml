<?xml version="1.0" encoding="UTF-8"?>
<screens xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/widget-screen.xsd">

    <screen name="FindMaterialRequest">
        <section>
            <actions>
                <set field="titleProperty" value="Requests"/>
                <set field="headerItem" value="request"/>
                <set field="tabButtonItem" value="FindMaterialRequest" />	
			    <set field="tabButtonItem2" value="FindMaterialRequest"/> 
                <set field="entityName" value="CustRequest"/>
                <set field="parameters.custRequestTypeId" value="PRODUCT_REQUIREMENT"/>
                <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/purchaseDepartments.groovy"/>
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    	<include-menu name="RequestTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <decorator-screen name="FindScreenDecorator" location="component://common/widget/CommonScreens.xml">
                            <decorator-section name="search-options">
                                <include-form name="FindMaterialRequest" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                            </decorator-section>
                            <decorator-section name="search-results">
                            	<screenlet>
                                	<include-form name="ListRequests" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                                </screenlet>
                            </decorator-section>
                        </decorator-screen>
                    </decorator-section>
                </decorator-screen>
            </widgets>
         </section>
    </screen>
    
    <screen name="StoreReturnRequests">
        <section>
            <actions>
                <set field="titleProperty" value="Return Requests"/>
                <set field="headerItem" value="return"/>
                <set field="tabButtonItem" value="FindMaterialIssuance" />	
			    <set field="tabButtonItem2" value="ReturnRequests"/> 
                <set field="parameters.returnHeaderTypeId" value="DEPARTMENT_RETURN"/>
                <entity-condition list="returnItemsList" entity-name="ReturnHeaderAndItem">
                	<condition-list combine="and">
                		<condition-expr field-name="returnHeaderTypeId" operator="equals" value="DEPARTMENT_RETURN"/>
	                	<condition-expr field-name="itemStatusId" operator="equals" value="RETURN_REQUESTED"/>
                	</condition-list>
                </entity-condition>
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    	<include-menu name="StoreIssueTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <screenlet title="Department Returns Request">
                   			<include-form name="ListReturnRequests" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                   		</screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
         </section>
    </screen>
    
    <screen name="FindMaterialReturns">
        <section>
            <actions>
                <set field="titleProperty" value="Returns"/>
                <set field="headerItem" value="return"/>
                <set field="tabButtonItem" value="FindMaterialReturns" />	
			    <set field="tabButtonItem2" value="FindMaterialReturns"/> 
                <set field="entityName" value="ReturnHeader"/>
                <set field="parameters.returnHeaderTypeId" value="DEPARTMENT_RETURN"/>
             <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/purchaseDepartments.groovy"/>
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    	<include-menu name="ReturnsTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <decorator-screen name="FindScreenDecorator" location="component://common/widget/CommonScreens.xml">
                            <decorator-section name="search-options">
                                <include-form name="FindMaterialReturn" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                            </decorator-section>
                            <decorator-section name="search-results">
                            	<screenlet>
                                	<include-form name="ListReturns" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                                </screenlet>
                            </decorator-section>
                        </decorator-screen>
                    </decorator-section>
                </decorator-screen>
            </widgets>
         </section>
    </screen>
    
    <screen name="FindMaterialEnquiry">
        <section>
            <actions>
                <set field="titleProperty" value="Enquiry"/>
                <set field="headerItem" value="request"/>
                <set field="tabButtonItem" value="FindMaterialEnquiry" />	
                <set field="tabButtonItem2" value="FindMaterialEnquiry"/>
                <set field="entityName" value="CustRequest"/>
                <set field="parameters.custRequestTypeId" value="RF_PUR_QUOTE"/>
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    	<include-menu name="FindEnquiryTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <decorator-screen name="FindScreenDecorator" location="component://common/widget/CommonScreens.xml">
                            <decorator-section name="search-options">
                                <include-form name="FindMaterialEnquiry" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                            </decorator-section>
                            <decorator-section name="search-results">
                            	<screenlet>
                                	<include-form name="ListEnquiry" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                                </screenlet>
                            </decorator-section>
                        </decorator-screen>
                    </decorator-section>
                </decorator-screen>
            </widgets>
         </section>
    </screen>
    
    <screen name="StoreProductIssue">
        <section>
            <actions>
                <set field="titleProperty" value="Issue"/>
                <set field="headerItem" value="Issue"/>
                <set field="tabButtonItem" value="FindMaterialIssuance" />	
                <set field="tabButtonItem2" value="StoreProductIssue" />	
                <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/RequestAvailableProductList.groovy"/>
                <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/purchaseDepartments.groovy"/>
                <set field="layoutSettings.javaScripts[]" value="/materialmgmt/images/requirements.js" global="true"/>
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    	<include-menu name="StoreIssueTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                    	<screenlet title="Search-Options">
                                <include-form name="FindIssueRequests" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                        </screenlet>
                     	<screenlet title="List Requests to Issue">
                     		<include-form name="ListRequestsToIssue" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                     	</screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
         </section>
    </screen>
    
    <screen name="FindMaterialIssuance">
        <section>
            <actions>
                <set field="titleProperty" value="Issue"/>
                <set field="headerItem" value="Issue"/>
                <set field="tabButtonItem" value="FindMaterialIssuance" />	
                <set field="tabButtonItem2" value="FindMaterialIssuance" />	
            <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/purchaseDepartments.groovy"/>
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    	<include-menu name="StoreIssueTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                     	<decorator-screen name="FindScreenDecorator" location="component://common/widget/CommonScreens.xml">
                            <decorator-section name="search-options">
                                <include-form name="FindMaterialIssuance" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                            </decorator-section>
                            <decorator-section name="search-results">
                            	<screenlet>
                            	    <include-form name="ListMaterialIssuance" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                            	</screenlet>
                            </decorator-section>
                        </decorator-screen>
                    </decorator-section>
                </decorator-screen>
            </widgets>
         </section>
    </screen>
    
    <screen name="FindMaterialIssuanceNew">
        <section>
            <actions>
                <set field="titleProperty" value="Issue"/>
                <set field="headerItem" value="Issue"/>
                <set field="tabButtonItem" value="FindMaterialIssuance" />	
                <set field="tabButtonItem2" value="FindMaterialIssuanceNew" />	
                <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/purchaseDepartments.groovy"/>
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    	<include-menu name="StoreIssueTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                     	<decorator-screen name="FindScreenDecorator" location="component://common/widget/CommonScreens.xml">
                            <decorator-section name="search-options">
                                <include-form name="FindMaterialIssuanceNew" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                            </decorator-section>
                            <decorator-section name="search-results">
                            	<screenlet>
                            	    <include-form name="ListMaterialIssuanceNew" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                            	</screenlet>
                            </decorator-section>
                        </decorator-screen>
                    </decorator-section>
                </decorator-screen>
            </widgets>
         </section>
    </screen>
    <screen name="ApproveRequestsByDeptHead">
        <section>
            <actions>
                <set field="titleProperty" value="Issue"/>
                <set field="headerItem" value="Issue"/>
                <set field="tabButtonItem" value="FindMaterialRequest" />
                <set field="tabButtonItem2" value="ApproveRequestsByDeptHead" />
                <set field="layoutSettings.javaScripts[]" value="/materialmgmt/images/requirements.js" global="true"/>
                <set field="entityName" value="CustRequestAndItemAndAttribute"/>
                <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/purchaseDepartments.groovy"/>
                <!-- <entity-condition list="custRequestItemsList" entity-name="CustRequestAndItemAndAttribute">
                	<condition-list combine="and">
                		<condition-list combine="or">
                			<condition-expr field-name="statusId" operator="equals" value="CRQ_DRAFT"/>
                			<condition-expr field-name="statusId" operator="equals" value="CRQ_SUBMITTED"/>
                		</condition-list>
						<condition-expr field-name="itemStatusId" operator="equals" value="CRQ_DRAFT"/>
						<condition-expr field-name="custRequestTypeId" operator="equals" value="PRODUCT_REQUIREMENT"/> 
                	</condition-list>
                	<order-by field-name="-custRequestDate"/>
                </entity-condition>	 -->
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                     	<include-menu name="RequestTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                     	<screenlet title="Search-Options">
                     			<include-form location="component://materialmgmt/widget/MaterialRequestForms.xml" name="SearchRequestsToApprove"/>
                     	</screenlet>
                     	<screenlet title="List Requests to Approve">
                     		<include-form name="ListRequestsToApprove" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                     	</screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
         </section>
    </screen>
    <screen name="ReturnEntry">
        <section>
            <actions>
               <set field="titleProperty" value="Return Entry"/>              
			   <set field="tabButtonItem" value="FindMaterialReturns" />	
			   <set field="tabButtonItem2" value="ReturnEntry"/>  
               <set field="supplyDate" from-field="parameters.supplyDate"/>
               <set field="screenFlag" value="RETURN"/>
               <set field="isFormSubmitted" from-field="parameters.isFormSubmitted"/>
               <set field="defaultEffectiveDateTime" value="${supplyDate}" default-value="${bsh:org.ofbiz.base.util.UtilDateTime.nowTimestamp()}"/>
			   <set field="defaultEffectiveDate" 
					value="${groovy:org.ofbiz.base.util.UtilDateTime.toDateString(defaultEffectiveDateTime, &quot;dd MMMMM, yyyy&quot;);}" />
			   <set field="parameters.roleTypeId" value="INTERNAL_ORGANIZATIO"/>
				<set field="productCategoryResult" value="${groovy:org.ofbiz.product.product.ProductWorker.getProductsByCategoryAssoc(delegator, 'INDENT_PROD_CAT', 'PUR_INDENT', null)}" />
				<set field="categoryList" value="${productCategoryResult.productCategory}"/>		
			   					  					  
            </actions>
            <widgets>
            <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
            	<decorator-section name="body">   
                	<include-menu name="ReturnsTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                      	<section>
	                      	  <condition>
	                             <if-compare operator="equals" field="isFormSubmitted" value=""/>
	                         </condition>
	                      		<widgets>
	           						<include-screen name="RequestInitEntry"/>
	                      		</widgets>
                      	</section>
                      <section>
                      <condition>
                      <if-compare operator="equals" field="isFormSubmitted" value="YES"/>
                      </condition>
                         <widgets>
     						 <include-screen name="RequestInnerScreen"/>
                		</widgets>
                      </section>
                      
                    </decorator-section>                                       
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="CustRequestEntry">
        <section>
            <actions>
               <set field="titleProperty" value="Request Entry"/>              
			   <set field="tabButtonItem" value="FindMaterialRequest" />	
			   <set field="tabButtonItem2" value="CustRequestEntry"/>  
               <set field="supplyDate" from-field="parameters.supplyDate"/>
               <set field="screenFlag" value="INDENT"/>
               <set field="isFormSubmitted" from-field="parameters.isFormSubmitted"/>
               <set field="defaultEffectiveDateTime" value="${supplyDate}" default-value="${bsh:org.ofbiz.base.util.UtilDateTime.nowTimestamp()}"/>
			   <set field="defaultEffectiveDate" 
					value="${groovy:org.ofbiz.base.util.UtilDateTime.toDateString(defaultEffectiveDateTime, &quot;dd MMMMM, yyyy&quot;);}" />
			   <set field="parameters.roleTypeId" value="INTERNAL_ORGANIZATIO"/>
				<set field="productCategoryResult" value="${groovy:org.ofbiz.product.product.ProductWorker.getProductsByCategoryAssoc(delegator, 'INDENT_PROD_CAT', 'PUR_INDENT', null)}" />
				<set field="categoryList" value="${productCategoryResult.productCategory}"/>		
			   					  					  
            </actions>
            <widgets>
            <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
            	<decorator-section name="body">   
                	<include-menu name="RequestTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                      	<section>
	                      	  <condition>
	                             <if-compare operator="equals" field="isFormSubmitted" value=""/>
	                         </condition>
	                      		<widgets>
	           						<include-screen name="RequestInitEntry"/>
	                      		</widgets>
                      	</section>
                      <section>
                      <condition>
                      <if-compare operator="equals" field="isFormSubmitted" value="YES"/>
                      </condition>
                         <widgets>
     						 <include-screen name="RequestInnerScreen"/>
                		</widgets>
                      </section>
                      
                    </decorator-section>                                       
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="RequestInitEntry">
        <section>
            <actions>
                
               <entity-one value-field="showBoothAutoSuggestConf" entity-name="TenantConfiguration">
               		<field-map field-name="propertyTypeEnumId" value="FACILITY_AUTOSUGGEST"/>
               		<field-map field-name="propertyName" value="showBoothAutoSuggest"/>
               		<select-field field-name="propertyValue"/>
               </entity-one>
               <set field="showBoothAutoSuggest" value="${showBoothAutoSuggestConf.propertyValue}"/>
               <set field="supplyDate" from-field="parameters.supplyDate"/>
               <set field="effectiveDate" value="${parameters.effectiveDate}"/>
               <set field="requiredDate" value="${parameters.requiredDate}"/>
               <!-- <set field="checkListType" value="indentEntry"/> -->
               <!-- <set field="shipmentTypeId" value="${parameters.shipmentTypeId}"/> -->
                <entity-condition entity-name="Product" list="productList" use-cache="true">
                </entity-condition>                
                <script location="component://byproducts/webapp/byproducts/WEB-INF/actions/facility/enablePartyAutoComplete.groovy"/>
            </actions>
            <widgets>
               	<section>
                 	 <widgets>
          					<platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/RequestEntry.ftl"/></html></platform-specific>
                     </widgets>
                     <fail-widgets>
						<label style="h3">${uiLabelMap.ProductFacilityViewPermissionError}
						</label>
					</fail-widgets>
             	</section>                  
            </widgets>
        </section>
    </screen>
    
    <screen name="RequestInnerScreen">
        <section>
            <actions>
            	<set field="changeFlag" from-field="changeFlag"/>  
                <set field="checkListType" value="indentEntry"/>
                <set field="effectiveDate" value="${parameters.effectiveDate}"/>
                <set field="requiredDate" value="${parameters.requiredDate}"/>
                <set field="productCategoryId" from-field="parameters.productCategoryId"/>
                <set field="custRequestName" from-field="parameters.custRequestName"/>
                <!-- <script location="component://byproducts/webapp/byproducts/WEB-INF/actions/facility/CustRequestIndentForm.groovy"/> -->
                <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/CustRequestIndentForm.groovy"/>
                
            </actions>
            <widgets>
                   <section>
               	   <condition>
               			<and>                     		
          					<if-has-permission permission="BYPRODUCTS" action="_INDENT"/>
              					<not><if-empty field="booth"/></not>
               			</and>
               		</condition> 
                       	<widgets>
                       	    <platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/RequestEntry.ftl"/></html></platform-specific>
                        </widgets>
                       <fail-widgets>
                           <platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/RequestEntry.ftl"/></html></platform-specific>								                           
                       </fail-widgets>
                   </section>
            </widgets>
        </section>
    </screen>
    
    <screen name="ViewCustRequest">
        <section>
            <actions>
                <set field="custRequestId" from-field="parameters.custRequestId" default-value="${parameters.id}"/>
                <entity-one entity-name="CustRequest" value-field="custRequest"/>
                <get-related-one value-field="custRequest" relation-name="CustRequestType" to-value-field="custRequestType"/>
                <get-related-one value-field="custRequest" relation-name="StatusItem" to-value-field="statusItem"/>
                <get-related-one value-field="custRequest" relation-name="CurrencyUom" to-value-field="currency"/>
                <get-related-one value-field="custRequest" relation-name="ProductStore" to-value-field="store"/>
                <get-related-one value-field="custRequest" relation-name="FulfillContactMech" to-value-field="fulfillContactMech"/>
                <!-- <entity-and list="requestWorkEfforts" entity-name="CustRequestAndWorkEffort">
                    <field-map field-name="custRequestId" from-field="parameters.custRequestId"/>
                </entity-and>
                 -->
                 <entity-and entity-name="CustRequestNoteView" list="enquiryNotes">
                    <field-map field-name="custRequestId" from-field="custRequestId"/>
                </entity-and>
                 <entity-and entity-name="CustRequestAndContent" list="custRequestContents" filter-by-date="true">
                    <field-map field-name="custRequestId" from-field="custRequestId"/>
                </entity-and>
                 <get-related value-field="custRequest" relation-name="CustRequestParty" list="requestParties"/>
                <set field="orderBy[]" value="sequenceNum"/>
                <get-related value-field="custRequest" relation-name="CustRequestItem" list="custRequestItems" order-by-list="orderBy"/>
            </actions>
            <widgets>
                <container style="lefthalf">
                    <screenlet title="${uiLabelMap.MaterialMangement_CustRequest}  ${custRequest.custRequestId}  ${uiLabelMap.CommonInformation}">
                        <include-form name="requestInfo" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                     <screenlet title="Indent Issuance">
	                   		<include-form location="component://materialmgmt/widget/MaterialRequestForms.xml" name="ListIndentIssues"/>
	                 </screenlet>
                  	<screenlet title="Indent Document : ${custRequestId}">
                   		<include-form location="component://materialmgmt/widget/MaterialRequestForms.xml" name="AddIndentContent"/>
                  	</screenlet>
                  	<screenlet title="Indent Contents">
                   		<include-form location="component://materialmgmt/widget/MaterialRequestForms.xml" name="ListIndentContent"/>
                  	</screenlet>
                    </screenlet>
                </container>
                <container style="righthalf">
                    <screenlet title="${uiLabelMap.MaterialMangement_CustRequest} Status" navigation-form-name="ViewRequest">
                        <include-form name="ViewRequestStatus" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                    </screenlet>
                    <screenlet title="Add Notes">
                       	<include-form name="AddCustRequestNote" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                  	</screenlet>
                  	<screenlet title="Indent Notes">
	                   		<include-form location="component://materialmgmt/widget/MaterialRequestForms.xml" name="ListEnquiryNotes"/>
	                 </screenlet>
                </container>
                <container style="clear"/>
                <screenlet title="${uiLabelMap.MaterialMangement_CustRequest} Items">
                    <include-form name="OverviewRequestItems" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                </screenlet>
            </widgets>
        </section>
    </screen>
    <screen name="ViewMaterialRequest">
        <section>
            <actions>
                <set field="headerItem" value="request"/>
                <set field="tabButtonItem" value="FindMaterialRequest" />
                <set field="tabButtonItem2" value="viewIndent"/>
                <set field="custRequestId" from-field="parameters.custRequestId" default-value="${parameters.id}"/>
                <entity-one entity-name="CustRequest" value-field="custRequest"/>	
            </actions>
            <widgets>
               <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    	<include-menu name="RequestTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <include-screen name="ViewCustRequest"/>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="ViewMaterialEnquiry">
        <section>
            <actions>
                <set field="headerItem" value="request"/>
                <set field="tabButtonItem" value="FindMaterialEnquiry" />
                <set field="tabButtonItem2" value="viewEnquiry" />
                <set field="custRequestId" from-field="parameters.custRequestId"/>
                <entity-one entity-name="CustRequest" value-field="custRequest"/>
                <entity-condition list="quoteQualifiedList" entity-name="QuoteAndItemAndCustRequest">
                	<!-- <condition-list combine="and"> -->
                		<condition-expr field-name="custRequestId" operator="equals" value="${parameters.custRequestId}"/>
                		<!-- <condition-list combine="or">
                		<condition-expr field-name="qiStatusId" operator="equals" value="QTITM_QUALIFIED"/>
                		<condition-expr field-name="qiStatusId" operator="equals" value="QTITM_REJECTED"/>
                		</condition-list>
                	</condition-list> -->
                	<order-by field-name="productId"/>
                </entity-condition>
                <entity-and entity-name="CustRequestAndContent" list="custRequestContents" filter-by-date="true">
                    <field-map field-name="custRequestId" from-field="custRequestId"/>
                </entity-and>
                <entity-and entity-name="CustRequestNoteView" list="enquiryNotes">
                    <field-map field-name="custRequestId" from-field="custRequestId"/>
                </entity-and>
                <!-- <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/EnquiryDetails.groovy" /> -->
                <set field="checkStatusId" value="${custRequest.statusId}"/>	
            </actions>
            <widgets>
               <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    <platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/email/EnquiryEmailOpen.ftl"/></html></platform-specific>
                    	<include-menu name="EnquiryTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                    	<container style="button-bar">
		                    <section>
			                  	 <condition> 
			                  	   <and>
				                  	   	<if-compare operator="equals" value="ENQ_CREATED" field="checkStatusId"/>
				                  	   	<if-has-permission permission="MM" action="_QUOTE_ADD"/>
			                  	   </and>
			                  	 </condition>
		                  	 	<widgets>
		                  	 		<link target="enquiryItemsForQuote" text="Add Quotation" style="buttontext create h2" >
                  	 					<parameter param-name="custRequestId"/>
                  	 				</link>
		                  	 	</widgets>
		                  </section>
                      </container>
                      <container style="lefthalf">
		                  <screenlet title="Overview">
		                  	 <include-form location="component://materialmgmt/widget/MaterialRequestForms.xml" name="EnquiryDetails"/>
		                  </screenlet>
		                  <!-- <include-screen name="MaterialNotes" location="component://materialmgmt/widget/MaterialRequestScreens.xml"/> -->
		                  <!-- <screenlet title="Enquiry Contents">
                   			<include-form location="component://materialmgmt/widget/MaterialRequestForms.xml" name="ListEnquiryContent"/>
                  	  	  </screenlet> -->
                  	  	   <screenlet title="Enquiry Document : ${custRequestId}">
                            <include-form name="AddCustRequestContent" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                        </screenlet>
	                  	<screenlet title="Enquiry Contents">
	                   		<include-form name="ListEnquiryContent" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
	                  	</screenlet>
                 	  </container>
                 
                 	  <container style="righthalf"> 
                 	  	<screenlet title="Add Supplier">
                 	  		<include-screen name="AddSupplier"/>
                 	  	</screenlet>
                  		<decorator-section-include name="Enquiry items"/>
		                  <screenlet title="Items In Enquiry"> 
		                   	<include-form location="component://materialmgmt/widget/MaterialRequestForms.xml" name="ItemsInEnquiry"/>
		                  </screenlet>
		                  <screenlet title="Add Notes"> 
		                    <include-screen name="AddCustEnquiryNote"/>
		                  </screenlet>
		              </container>
                 		
                 	  <container style="righthalf">
                  
                  		<!-- <section>
                  			<condition> 
                  	  			<not> <if-empty field="notes"/></not>
                  	 		</condition>
                  	 		<widgets>
		                  	 <screenlet title="PreBid Meeting Notes">
		                  	     <label text="PreBid Notes added By  : ${notes[0].firstName} ${notes[0].lastName}" style="h5"></label>
		                  	     <label ></label>
		                  	     <label style="h5" text="Create on :${bsh:org.ofbiz.base.util.UtilDateTime.toDateString(noteDate,&quot;dd/MM/yyyy&quot;)}"></label>
		                  	     <link style="button h2" target="PreBidNotePdf.pdf" text="Pdf" >
		                             <parameter param-name="custRequestId"/>
		                         </link>
		                         <link style="button h6" target="PreBidNotes" text="Show Prebid Notes" >
		                             <parameter param-name="custRequestId"/>
		                         </link>
		                  	 </screenlet>
		                   </widgets>
		                  	 <fail-widgets>
		                  	   <screenlet title="PreBid Meeting Notes">
		                  	    <label text="Pre Bid Notes are not Available" style="h6"></label>
		                  	   </screenlet>
		                  	 </fail-widgets>
                  		</section> -->
	               </container>
                  <container style="clear"></container>
                  <container style="full">
                  	<screenlet title="Qualified Enquiry Item">
                    	<include-form name="ListQualifiedQuotesForPO" location="component://materialmgmt/widget/MaterialQuoteForms.xml"/>
                    </screenlet>
                  </container>
                 
                  </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="EnquiryItemsForQuote">
        <section>
            <actions>
                <set field="titleProperty" value="Add Items to Quote"/>
                <set field="tabButtonItem" value="FindMaterialQuotes"/>
                  <set field="tabButtonItem2" value="createQuotation"/>
                <set field="headerItem" value="request"/>
                <set field="flag" value="N"/>
                <set field="custRequestId" from-field="parameters.custRequestId" from-scope="screen" to-scope="screen"/>
                <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/SelectItemsToQuote.groovy" />
                <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/materialSupplierAutoComplete.groovy"/>
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    <include-menu name="FindMaterialQuotesTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                     <screenlet title="Select Items to Quote">
                          <platform-specific>
                            <html>
                                <html-template location="component://materialmgmt/webapp/materialmgmt/purchase/ListEnquiryItemsToQuote.ftl"/>
                            </html>
                          </platform-specific>
                        </screenlet>  
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="EditQuotItems">
        <section>
            <actions>
                <set field="titleProperty" value="Edit Quote Items"/>
                <set field="tabButtonItem" value="FindMaterialQuotes"/>
                <set field="tabButtonItem2" value="updateQuotation"/>
                <set field="headerItem" value="request"/>
                <set field="flag" from-field="parameters.flag"/>
               <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/EditQuoteItems.groovy" />
               <script location="component://byproducts/webapp/byproducts/WEB-INF/actions/facility/enablePartyAutoComplete.groovy"/>
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    <include-menu name="FindMaterialQuotesTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                     <screenlet title="Edit Quote Items">
                          <platform-specific>
                            <html>
                                <html-template location="component://materialmgmt/webapp/materialmgmt/purchase/ListEnquiryItemsToQuote.ftl"/>
                            </html>
                          </platform-specific>
                        </screenlet>  
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="NewRequirement">
    	<section>
    		<actions>
    			<set field="titleProperty" value="Create New Requirement"/>
                <set field="tabButtonItem" value="FindMaterialRequirement"/>
    		</actions>
    		<widgets>
    			<decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    	<screenlet title="Create New Requirement" >
                    		<include-form location="component://materialmgmt/widget/MaterialRequestForms.xml" name="AddRequirement"/>
                    	</screenlet>
                    </decorator-section>
                </decorator-screen>    
    		</widgets>
    	</section>
    </screen>
    <screen name="FindMaterialInvoices">
    	<section>
    		<actions>
    			 <set field="titleProperty" value="Find Material Invoice"/>
                <set field="tabButtonItem" value="FindMaterialInvoices"/>
                <set field="entityName" value="Invoice"/>
    		</actions>
    		<widgets>
    			<decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
    					<screenlet title="Search Options">
    						<include-form location="component://materialmgmt/widget/MaterialRequestForms.xml" name="FindMaterialInvoice"/>
    					</screenlet>
    					<screenlet title="Search Results">
    						<include-form location="component://materialmgmt/widget/MaterialRequestForms.xml" name="ListMaterialInvoice"/>
    					</screenlet>
    				</decorator-section>
    			</decorator-screen>	
    		</widgets>
    	</section>
    </screen>
    <screen name="AddEnquiryContent">
        <section>
            <actions>
                <set field="titleProperty" value="Enquiry Document"/>
                <set field="tabButtonItem" value="FindMaterialEnquiry"/>
                <set field="tabButtonItem2" value="AddEnquiryContent"/>
                <set field="headerItem" value="request"/>
                <set field="custRequestId" from-field="parameters.custRequestId" />
                <entity-and entity-name="CustRequestAndContent" list="custRequestContents" filter-by-date="true">
                    <field-map field-name="custRequestId" from-field="custRequestId"/>
                </entity-and>
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    	<include-menu name="EnquiryTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                     	<screenlet title="Enquiry content : ${custRequestId}">
                            <include-form name="AddCustRequestContent" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                        </screenlet>
                        <include-form name="ListEnquiryContent" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
   
    <screen name="AddIndentContent">
        <section>
            <actions>
                <set field="titleProperty" value="Enquiry Document"/>
                <set field="tabButtonItem" value="FindMaterialRequest"/>
                <set field="tabButtonItem2" value="addIndentContent"/>
                <set field="headerItem" value="request"/>
                <set field="custRequestId" from-field="parameters.custRequestId" />
                <entity-and entity-name="CustRequestAndContent" list="custRequestContents" filter-by-date="true">
                    <field-map field-name="custRequestId" from-field="custRequestId"/>
                </entity-and>
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    	<include-menu name="RequestTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                     	<screenlet title="Indent content : ${custRequestId}">
                            <include-form name="AddIndentContent" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                        </screenlet>
                        <include-form name="ListIndentContent" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="RequestsReceiptAcknowledgement">
        <section>
            <actions>
                <set field="titleProperty" value="Material Receipt Acknowledgment"/>
                <set field="tabButtonItem" value="FindMaterialRequest"/>
                <set field="tabButtonItem2" value="RequestsReceiptAcknowledgement"/>
                <set field="headerItem" value="request"/>
                <set field="custRequestId" from-field="parameters.custRequestId" from-scope="screen" to-scope="screen"/>
                <entity-condition list="indentItems" entity-name="CustRequestAndItemAndAttribute">
                	<condition-expr field-name="itemStatusId" operator="equals" value="CRQ_ISSUED"/>
                	<order-by field-name="fromPartyId"/>
                </entity-condition>
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    <include-menu name="RequestTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                     <screenlet title="Acknowledge Receipts">
                          <platform-specific>
                            <html>
                                <html-template location="component://materialmgmt/webapp/materialmgmt/purchase/ListIndentForAcceptance.ftl"/>
                            </html>
                          </platform-specific>
                        </screenlet>  
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="AddSupplier">
    <section>
    	<actions>
    		<entity-condition list="supplierList" entity-name="CustRequestParty">
    			<condition-expr field-name="custRequestId" from-field="parameters.custRequestId"/>
    		</entity-condition>
    	</actions>
    	<widgets>
    		<include-form location="component://materialmgmt/widget/MaterialRequestForms.xml" name="AddSupplier"/>
    		<screenlet>
    			<include-form location="component://materialmgmt/widget/MaterialRequestForms.xml" name="listSuppliers"/>
    		</screenlet>
    	</widgets>
    </section>
    </screen>
    <screen name="AddCustEnquiryNote">
    <section>
    	<widgets>
    			<include-form name="AddCustEnquiryNote" location="component://materialmgmt/widget/MaterialRequestForms.xml"/>
    		<screenlet>
    			<include-form location="component://materialmgmt/widget/MaterialRequestForms.xml" name="ListEnquiryNotes"/>
    		</screenlet>
    	</widgets>
    </section>
    </screen>
</screens>