<?xml version="1.0" encoding="UTF-8"?>
<forms xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/widget-form.xsd">

	<form name="FindPurchaseOrder" title="" type="single" target="${targetRequest}" header-row-style="header-row" default-table-style="basic-table">
        <field title="Delivery Date" name="estimatedDeliveryDate"><date-find/></field>
        <field name="orderId"><text-find/></field>
        <field name="orderTypeId"><hidden value="PURCHASE_ORDER"/></field>
        <field name="salesChannelEnumId" ><hidden value="${ChannalType}"/></field>
        <field name="statusId">
        	<drop-down>
        		<option key="ORDER_APPROVED" description="Approved"/>
        		<option key="ORDER_CANCELLED" description="Cancelled"/>
        	</drop-down>
        	<!-- <drop-down>
        		<entity-options description="${statusCode}" entity-name="StatusItem" key-field-name="statusId" >
        			<entity-constraint name="statusTypeId" operator="equals" value="ORDER_STATUS"/>
        		</entity-options>
        	</drop-down> -->
        </field>
        <field name="noConditionFind"><hidden value="Y"/><!-- if this isn't there then with all fields empty no query will be done --></field>
        <field name="submitButton" title="${uiLabelMap.CommonFind}" widget-style="smallSubmit"><submit button-type="button"/></field>
    </form>
    
     <form name="listPurchaseOrders" type="list" list-name="listIt" paginate-target="${targetRequest}"
        odd-row-style="alternate-row" header-row-style="header-row-2" default-table-style="basic-table hover-bar">
        <actions>
            <service service-name="performFind" result-map="result" result-map-list="listIt">
                <field-map field-name="inputFields" from-field="parameters"/>
                <field-map field-name="entityName" value="OrderHeader"/>
                <field-map field-name="orderBy" from-field="parameters.sortField" value="-lastUpdatedStamp"/>
                <field-map field-name="viewIndex" from-field="viewIndex"/>
                <field-map field-name="viewSize" from-field="viewSize"/>
            </service>
        </actions>
        <row-actions>
            <entity-and entity-name="OrderItemBilling" list="invoices">
                <field-map field-name="orderId"/>
            </entity-and>
            <set field="invoiceId" from-field="invoices[0].invoiceId"/>  
            <set field="invTotal" value="${bsh:org.ofbiz.accounting.invoice.InvoiceWorker.getInvoiceTotal(delegator,invoiceId)}"></set>  
         
              <entity-and entity-name="PaymentApplication" list="paymentApplications">
                <field-map field-name="invoiceId"/>
            </entity-and>
           <set field="paymentApplicationId" from-field="paymentApplications[0].paymentApplicationId"/>
           
           <entity-one entity-name="Invoice" value-field="invoice">
        		<field-map field-name="invoiceId" from-field="invoiceId" />
        	</entity-one>
        	<set field="partyIdFrom" from-field="invoice.partyIdFrom" />
        	<set field="supplierName" value="${bsh:org.ofbiz.party.party.PartyHelper.getPartyName(delegator,partyIdFrom,false);}"></set>
        	<set field="invStatusId" from-field="invoice.statusId"/>
        </row-actions>
      
        <field name="partyIdFrom" title="Supplier Code"> <display  description="${supplierName}[${partyIdFrom}]"> </display></field>
         <field name="shipmentId" ><hidden></hidden></field>
        <field name="invoiceId" title="Invoice Id" widget-style="buttontext"><hyperlink target="invoiceOverview" target-window="_blank" description="${invoiceId}"> <parameter param-name="invoiceId"/></hyperlink>        </field>
        <field name="invTotal" title="Invoice Amt (Rs)"><display/></field>
        <field name="invStatusId" title="Status Id" ><display-entity key-field-name="statusId" description="${description}" entity-name="StatusItem"/></field>
        <field name="estimatedDeliveryDate" title="Delivery Date"><display description="${groovy:org.ofbiz.base.util.UtilDateTime.toDateString(estimatedDeliveryDate, &quot;dd/MM/yyyy&quot;);}"/></field>
        <field name="createdBy" title="Created By"><display/></field>
        <field name="salesChannelEnumId"><display/></field>
      
        <field name="lastUpdatedStamp" title="Last Update"><display description="${groovy:org.ofbiz.base.util.UtilDateTime.toDateString(lastUpdatedStamp, &quot;dd/MM/yyyy HH:mm:ss&quot;);}" /></field>
        <!--  <field use-when="statusId.equals(&quot;ORDER_APPROVED&quot;)" name="Order" widget-style="buttontext" >
            <hyperlink target="printAdhocOrder" description="Print Order" target-window="_blank">
             <parameter param-name="estimatedDeliveryDate"/>
                <parameter param-name="orderId"/>
                <parameter param-name="statusId"/>
                <parameter param-name="originFacilityId"/>
                  <parameter param-name="shipmentId"/>
            </hyperlink>
        </field> -->
         <!--  <field use-when="statusId.equals(&quot;ORDER_APPROVED&quot;)" name="GatePass" widget-style="buttontext" >
            <hyperlink target="AdhocTruckSheetReport.txt" description="GatePass" target-window="_blank">
                 <parameter param-name="shipmentTypeId" from-field="shipmentTypeId"/> 
               	  <parameter param-name="estimatedShipDate" from-field="estimatedDeliveryDate"/>
               	  <parameter param-name="shipmentId" /> 
            </hyperlink>
        </field> 
        <field name="InvoiceSlips" widget-style="buttontext" use-when="&quot;${statusId}&quot;==&quot;ORDER_APPROVED&quot;"  id-name = "invoiceSlips">
            <hyperlink target="Invoice.txt" description="Invoice Slips" target-window="_blank"> 	
                  <parameter param-name="shipmentTypeId" from-field="shipmentTypeId"/> 
               	  <parameter param-name="estimatedShipDate" from-field="estimatedDeliveryDate"/>
               	  <parameter param-name="reportTypeFlag" value="invoiceSlips"/> 
               	   <parameter param-name="shipmentId" /> 
            </hyperlink>
        </field>
        <field use-when="&quot;${statusId}&quot;==&quot;ORDER_APPROVED&quot;" name="buyerInvoice" widget-style="buttontext" id-name = "invoiceSlips">
            <hyperlink target="buyerInvoice.pdf" description="New Invoice Format" target-window="_blank"> 	
                  <parameter param-name="shipmentTypeId" from-field="shipmentTypeId"/> 
               	  <parameter param-name="estimatedShipDate" from-field="estimatedDeliveryDate"/>
               	  <parameter param-name="invoiceId" from-field="invoiceId"/>
               	  <parameter param-name="shipmentId" /> 
            </hyperlink>
        </field> 
         <field use-when="statusId.equals(&quot;ORDER_APPROVED&quot;) &amp;&amp; paymentApplicationId==null" name="PayAmount" widget-style="buttontext"  >
            <hyperlink target="createAdhocSalePayment" description="Pay Order" target-window="_blank" >
             <parameter param-name="estimatedDeliveryDate"/>
                <parameter param-name="orderId"/>
                  <parameter param-name="invoiceId"/>
                   <parameter param-name="amount" value="${invTotal}"/>
                <parameter param-name="statusId"/>
                <parameter param-name="facilityId"  from-field="originFacilityId"/>
                  <parameter param-name="shipmentId"/>
            </hyperlink>
        </field> -->
       <!--  <field use-when="statusId.equals(&quot;ORDER_APPROVED&quot;)" name="EditOrder" widget-style="buttontext" >
            <hyperlink target="AdhocOrderCorrection" description="Edit Order" target-window="_blank">
             <parameter param-name="estimatedDeliveryDate"/>
                <parameter param-name="orderId"/>
                <parameter param-name="statusId"/>
                <parameter param-name="originFacilityId"/>
                  <parameter param-name="shipmentId"/>
            </hyperlink>
        </field> -->
        <field name="debitNote" use-when="salesChannelEnumId.equals(&quot;INTER_PRCHSE_CHANNEL&quot;)"  title="Debit/Credit Note" widget-style="buttontext" id-name = "DebitNote">
            <hyperlink target="DebitNote" description="Debit/Credit Note" target-window="_blank"> 	
               	  <parameter param-name="orderId"/>
               	  <parameter param-name="reportTypeFlag" value="debitNote"/> 
            </hyperlink>
        </field>
        <field use-when="statusId.equals(&quot;ORDER_APPROVED&quot;) &amp;&amp; paymentApplicationId==null &amp;&amp;  salesChannelEnumId.equals(&quot;PROD_PRCHSE_CHANNEL&quot;)" name="cancelOrder" widget-style="buttontext">
            <hyperlink target="cancelPurchaseOrder" description="Cancel Order">
                <parameter param-name="orderId"/>
                <parameter param-name="statusId"/>
                <parameter param-name="partyId" from-field="partyIdFrom"/>
            </hyperlink>
        </field> 
         <field use-when="statusId.equals(&quot;ORDER_APPROVED&quot;) &amp;&amp;   salesChannelEnumId.equals(&quot;INTER_PRCHSE_CHANNEL&quot;)" name="cancelOrder" widget-style="buttontext">
            <hyperlink target="cancelInterUnitPurchaseOrder" description="Cancel  Order">
                <parameter param-name="orderId"/>
                <parameter param-name="statusId"/>
                <parameter param-name="partyId" from-field="partyIdFrom"/>
            </hyperlink>
        </field> 
    </form>
    <form name="OutstandingPurchaseOrders" type="list" list-name="purchaseOrders"
        odd-row-style="alternate-row" default-table-style="basic-table">
        <field name="orderDate"><display/></field>
        <field name="orderId">
            <hyperlink also-hidden="false" description="${orderId}" target="/ordermgr/control/orderview" target-type="inter-app">
                <parameter param-name="orderId"/>
            </hyperlink>
        </field>
        <field name="orderItemSeqId"><display/></field>
        <field name="quantity"><display/></field>
        <field name="cancelQuantity"><display/></field>
        <field name="itemStatusId"><display-entity entity-name="StatusItem" key-field-name="statusId"/></field>
        <field name="estimatedShipDate"><display/></field>
        <field name="estimatedDeliveryDate"><display/></field>
        <field name="shipBeforeDate"><display/></field>
        <field name="shipAfterDate"><display/></field>
    </form>
    <form name="ListRequirements" type="list" target="" title="" list-name="requirmentsList" paginate-target="FindRequirements"
        odd-row-style="alternate-row" default-table-style="basic-table hover-bar">
      
        <row-actions>
            <set field="lookupProductId" value="${bsh: (productId == null? &quot;_NA_&quot;: productId);}" type="String"/>
            <set field="lookupFacilityId" value="${bsh: (facilityIdId == null? &quot;_NA_&quot;: facilityId);}" type="String"/>
            <service service-name="getInventoryAvailableByFacility" result-map="resultQoh">
                <field-map field-name="productId" from-field="lookupProductId"/>
                <field-map field-name="facilityId" from-field="lookupFacilityId"/>
            </service>
            <service service-name="getProductInventoryAvailable" result-map="resultQohTotal">
                <field-map field-name="productId" from-field="lookupProductId"/>
            </service>
            <set field="facilityQuantityOnHandTotal" from-field="resultQoh.quantityOnHandTotal"/>
            <set field="quantityOnHandTotal" from-field="resultQohTotal.quantityOnHandTotal"/>
        </row-actions>
        <field name="requirementId" widget-style="buttontext">
            <hyperlink target-type="inter-app" description="${requirementId}" target="/ordermgr/control/EditRequirement">
                <parameter param-name="requirementId"/>
            </hyperlink>
        </field>
        <field name="statusId"><display-entity entity-name="StatusItem" description="${description}"/></field>
        <field name="requirementTypeId">
            <display-entity entity-name="RequirementType"/>
        </field>
        <field name="facilityId"><display/></field>
        <field name="productId">
            <display-entity entity-name="Product" key-field-name="productId" description="${productId} - ${internalName}"/>
        </field>
        <field name="requirementStartDate"><display/></field>
        <field name="requiredByDate"><display/></field>
        <field name="quantity" title="${uiLabelMap.CommonQuantity}"><display/></field>
        <field name="facilityQuantityOnHandTotal"><display/></field>
        <field name="quantityOnHandTotal"><display/></field>
        <field name="requestsLink" widget-style="buttontext">
            <hyperlink description="${uiLabelMap.OrderRequests}" target="ListRequirementCustRequests">
                <parameter param-name="requirementId"/>
            </hyperlink>
        </field>
        <field name="ordersLink" widget-style="buttontext">
            <hyperlink description="${uiLabelMap.CommonOrders}" target="ListRequirementOrders">
                <parameter param-name="requirementId"/>
            </hyperlink>
        </field>
        <field name="deleteLink" widget-style="buttontext" title="${uiLabelMap.CommonEmptyHeader}">
            <hyperlink description="${uiLabelMap.CommonRemove}" target="deleteRequirement">
                <parameter param-name="requirementId"/>
            </hyperlink>
        </field>
    </form>
     <form name="ListSupplierProducts" type="list" target="updateSupplierProduct" title="" list-name="listIt"
        odd-row-style="alternate-row" default-table-style="basic-table">
        <actions>
            <service service-name="performFind" result-map="result" result-map-list="listIt">
                <field-map field-name="inputFields" from-field="requestParameters"/>
                <field-map field-name="entityName" value="SupplierProduct"/>
                <field-map field-name="orderBy" from-field="parameters.sortField"/>
                <field-map field-name="viewIndex" from-field="viewIndex"/>
                <field-map field-name="viewSize" from-field="viewSize"/>
            </service>
        </actions>
        <field name="partyId" title="${uiLabelMap.ProductSupplier}">
            <display-entity entity-name="PartyNameView" also-hidden="true" description="${firstName} ${middleName} ${lastName} ${groupName}">
                <sub-hyperlink target="/partymgr/control/viewprofile" target-type="inter-app" description="${partyId}" link-style="buttontext">
                    <parameter param-name="partyId"/>
                </sub-hyperlink>
            </display-entity>
        </field>
        <field name="supplierProductId"><display/></field>
        <field name="minimumOrderQuantity" title="${uiLabelMap.ProductMinimumOrderQuantity}" sort-field="true">
            <display type="date-time"/>
        </field>
        <field name="supplierPrefOrderId">
            <display-entity entity-name="SupplierPrefOrder"/>
        </field>
        <field name="availableFromDate" title="${uiLabelMap.ProductAvailableFromDate}" red-when="after-now" sort-field="true"><display/></field>
        <field name="availableThruDate" title="${uiLabelMap.ProductAvailableThruDate}" red-when="before-now" sort-field="true"><display/></field>
        <field name="quantityUomId"><display-entity entity-name="Uom" key-field-name="uomId"/></field>
        <!-- field name="supplierCommissionPerc"><display/></field-->
        <field name="lastPrice" sort-field="true">
            <display type="currency" currency="${currencyUomId}"/>
        </field>
        <!-- <field name="shippingPrice">
            <display type="currency" currency="${currencyUomId}"/>
        </field>
        <field name="editLink" title="${uiLabelMap.CommonEmptyHeader}" widget-style="buttontext">
            <hyperlink target="EditProductSuppliers" description="${uiLabelMap.CommonEdit}" also-hidden="false">
                <parameter param-name="productId"/>
                <parameter param-name="partyId"/>
                <parameter param-name="currencyUomId"/>
                <parameter param-name="minimumOrderQuantity"/>
                <parameter param-name="availableFromDate"/>
            </hyperlink>
        </field>
        <field name="deleteLink" title="${uiLabelMap.CommonEmptyHeader}" widget-style="buttontext">
            <hyperlink target="removeSupplierProduct" description="${uiLabelMap.CommonDelete}" also-hidden="false">
                <parameter param-name="productId"/>
                <parameter param-name="partyId"/>
                <parameter param-name="currencyUomId"/>
                <parameter param-name="minimumOrderQuantity"/>
                <parameter param-name="availableFromDate"/>
            </hyperlink>
        </field> -->
    </form>
     <form name="ListRequestList" type="list" use-row-submit="true" list-name="custRequestsList" title="List of customer requests"
        odd-row-style="alternate-row" header-row-style="header-row-2" default-table-style="basic-table hover-bar">
        <field name="custRequestId" sort-field="true" title="RequestId" widget-style="buttontext">
            <hyperlink description="${custRequestId}" target="ViewMaterialRequest" target-window="_blank">
                <parameter param-name="custRequestId"/>
            </hyperlink>
        </field>
        <field name="custRequestDate" sort-field="true" title="Request Date"><display description="${bsh:org.ofbiz.base.util.UtilDateTime.toDateString(custRequestDate,&quot;dd/MM/yyyy&quot;)}"/></field>
        <field name="fromPartyId" sort-field="true">
            <display-entity entity-name="PartyNameView" key-field-name="partyId" description="${firstName} ${middleName} ${lastName} ${groupName}">
                <sub-hyperlink description="[${fromPartyId}]" target="/partymgr/control/viewprofile" target-type="inter-app">
                    <parameter param-name="partyId" from-field="fromPartyId"/>
                </sub-hyperlink>
            </display-entity>
        </field>
        <field name="custRequestName" title="Request Title"><display/></field>
        <field name="statusId" sort-field="true" title="Status">
            <display-entity also-hidden="false" entity-name="StatusItem"/>
        </field>
        <!-- <field name="lastModifiedDate" sort-field="true"><display/></field>
        <field name="createdByUserLogin" sort-field="true"><display/></field> -->
        
       
    </form>
    <form name="PurchaseReportForms" type="list" list-name="prodCatAnalysisList" view-size="99999">
        <field name="voucherCode" title="Voucher Code"><display/></field>
        <field name="analysisCode" title="Narration"><display/></field>
        <field name="totalRevenue" title="Amount"><display/></field>
    </form>  
     <form name="PurchaseAbstractReportForms" type="list" list-name="prodCatAnalysisList" view-size="99999">
        <field name="voucherCode" title="Voucher Code"><display/></field>
        <field name="analysisCode" title="Narration"><display/></field>
        <field name="invoiceId" title="Invoice Id"><display/></field>
        <field name="invoiceDate" title="invoice Date"><display/></field>
        <field name="productId" title="product Id"><display/></field>
        <field name="totalRevenue" title="Amount"><display/></field>
    </form>  
</forms>