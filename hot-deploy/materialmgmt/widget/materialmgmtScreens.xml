<?xml version="1.0" encoding="UTF-8"?>
<screens xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/widget-screen.xsd">

    <screen name="main">
        <section>
            <actions>
                <set field="headerItem" value="main"/><!-- this highlights the selected menu-item with name "main" -->
                  <set field="titleProperty" value="Find Purchase Orders"/>
                    <set field="tabButtonItem" value="FindPurchaseOrder" />	
			        <set field="tabButtonItem2" value="FindPurchaseOrder"/>   
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                      <include-menu name="PurchasesTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <section>
                            <widgets>
                                <decorator-screen name="FindScreenDecorator" location="component://common/widget/CommonScreens.xml">
			                     <decorator-section name="search-options">
			                            			<include-form name="FindPurchaseOrder" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
			                      </decorator-section>
			                      <decorator-section name="search-results">
			                      					<screenlet title="">
			                          					<include-form name="listPurchaseOrders" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
			                      					</screenlet>
			                      </decorator-section>
			                      </decorator-screen>
			                  </widgets>
			                </section>
			         </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="mainNG">
        <section>
            <actions>
                <set field="headerItem" value="mainNG"/><!-- this highlights the selected menu-item with name "main" -->
                  <set field="titleProperty" value="Find Request"/>
                    <set field="tabButtonItem" value="FindMaterialRequest" />	
			        <set field="tabButtonItem2" value="FindMaterialRequest"/>   
            </actions>
            <widgets>
	           	<include-screen name="FindMaterialRequest" location="component://materialmgmt/widget/MaterialRequestScreens.xml"/>
            </widgets>
        </section>
    </screen>

  <screen name="FindPurchaseOrder">
        <section>
            <actions>
                <set field="titleProperty" value="Find Purchase Order"/>              
			    <set field="tabButtonItem" value="FindPurchaseOrder" />	
			   <set field="tabButtonItem2" value="FindPurchaseOrder"/>       
               <set field="headerItem" value="byProductsOrderEntry"/>
               <set field="viewSize" from-field="parameters.VIEW_SIZE"/>
               <set field="targetRequest" value="FindPurchaseOrder"/>
                <set field="ChannalType" value="PROD_PRCHSE_CHANNEL"/> 
             <!--   <set field="ChannalType" value="RM_DIRECT_CHANNEL"/> -->
            </actions>
            <widgets>
                 <decorator-screen name="materialmgmtCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">  
                         <include-menu name="PurchasesTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <section>
                            <widgets>
                                <decorator-screen name="FindScreenDecorator" location="component://common/widget/CommonScreens.xml">
                                    <decorator-section name="search-options">
                            			<include-form name="FindPurchaseOrder" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                      				</decorator-section>
                      				<decorator-section name="search-results">
                      					<screenlet title="">
                      						<!-- <link target="parlourSalesOrders.csv" text="Export As CSV" style="buttontext create">
									  	 		<parameter param-name="orderId" from-field="parameters.orderId"/>
												<parameter param-name="hideSearch" from-field="parameters.hideSearch"/>
												<parameter param-name="orderDate" from-field="parameters.orderDate"/>
												<parameter param-name="orderType" from-field="parameters.orderType"/>
												<parameter param-name="salesChannelEnumId" from-field="parameters.salesChannelEnumId"/>
												<parameter param-name="statusId" from-field="parameters.statusId"/>
												<parameter param-name="productStoreId" from-field="parameters.productStoreId"/>
												<parameter param-name="noConditionFind" from-field="parameters.noConditionFind"/>
									  	 	</link> -->
                          					<include-form name="listPurchaseOrders" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                      					</screenlet>
                      				</decorator-section>
                                </decorator-screen>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>            
        </section>
    </screen> 
<screen name="PurchaseOrderInit">
        <section>
            <actions>
               <set field="titleProperty" value="Purchase Order Entry"/>              
			   <set field="tabButtonItem" value="FindPurchaseOrder" />	
			   <set field="tabButtonItem2" value="newPurchaseOrder"/>  
			    <set field="changeFlag" value="PurchaseOrder"/>  
               <set field="priceTypeId" from-field="parameters.priceTypeId"/>
               <set field="orderStatus" from-field="parameters.orderStatus"/> 
               <set field="orderId" from-field="parameters.orderId"/>
               <set field="orderFacility" from-field="parameters.orderFacility"/> 
               <set field="orderRoute" from-field="parameters.orderRoute"/> 
               <set field="supplyDate" from-field="parameters.supplyDate"/>
                <set field="isFormSubmitted" from-field="parameters.isFormSubmitted"/>
               <set field="defaultEffectiveDateTime" value="${supplyDate}" default-value="${bsh:org.ofbiz.base.util.UtilDateTime.nowTimestamp()}"/>
			   <set field="defaultEffectiveDate" 
					value="${groovy:org.ofbiz.base.util.UtilDateTime.toDateString(defaultEffectiveDateTime, &quot;dd MMMMM, yyyy&quot;);}" />	
				 <set field="parameters.roleTypeId" value="MAINSTORE_VENDOR"/>
            </actions>
            <widgets>
              <decorator-screen name="materialmgmtCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">   
                      <include-menu name="PurchasesTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                      	<section>
	                      	  <condition>
	                             <if-compare operator="equals" field="isFormSubmitted" value=""/>
	                         </condition>
	                      		<widgets>
	           						<include-screen name="PurchaseOrderInner"/>
	                      		</widgets>
                      	</section>
                      <section>
                      <condition>
                      <if-compare operator="equals" field="isFormSubmitted" value="YES"/>
                      </condition>
                                <widgets>
	           						 <include-screen name="PurchaseOrderEntry"/>
	                      		</widgets>
                      </section>
                    </decorator-section>                                       
                </decorator-screen>
            </widgets>
        </section>
    </screen> 
    <screen name="PurchaseOrderInner">
        <section>
            <actions>
               <set field="changeFlag" from-field="changeFlag"/> 
               <set field="productSubscriptionTypeId" value="${parameters.productSubscriptionTypeId}"/>
               <set field="subscriptionTypeId" from-field="parameters.subscriptionTypeId"/>
               <entity-one value-field="showBoothAutoSuggestConf" entity-name="TenantConfiguration">
               		<field-map field-name="propertyTypeEnumId" value="FACILITY_AUTOSUGGEST"/>
               		<field-map field-name="propertyName" value="showBoothAutoSuggest"/>
               		<select-field field-name="propertyValue"/>
               </entity-one>
               <set field="showBoothAutoSuggest" value="${showBoothAutoSuggestConf.propertyValue}"/>
               <set field="supplyDate" from-field="parameters.supplyDate"/>
               <set field="effectiveDate" value="${parameters.effectiveDate}"/>
               <set field="shipmentTypeId" value="${parameters.shipmentTypeId}"/>
               <!--  <set field="parameters.roleTypeId" value="IC_WHOLESALE"/> -->
               <!--  <script location="component://byproducts/webapp/byproducts/WEB-INF/actions/facility/enableBoothAutoComplete.groovy"/> -->
                
                <script location="component://byproducts/webapp/byproducts/WEB-INF/actions/facility/enablePartyAutoComplete.groovy"/>
                <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/orgnigationDept.groovy"/>
            </actions>
            <widgets>
               	<section>
                 	 <widgets>
          					<platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/PurchaseOrder.ftl"/></html></platform-specific>
                     </widgets>
                     <fail-widgets>
						<label style="h3">${uiLabelMap.ProductFacilityViewPermissionError}
						</label>
					</fail-widgets>
             	</section>                  
            </widgets>
        </section>
    </screen>   
    <screen name="PurchaseOrderEntry">
        <section>
            <actions>
               <set field="changeFlag" from-field="changeFlag"/>  
               <set field="productSubscriptionTypeId" from-field="parameters.productSubscriptionTypeId"/>
               <set field="subscriptionTypeId" from-field="parameters.subscriptionTypeId"/> 
               <set field="boothId" from-field="parameters.boothId"/>
                <set field="checkListType" value="indentEntry"/>
                <set field="effectiveDate" value="${parameters.effectiveDate}"/>
                 <set field="shipmentTypeId" value="${parameters.shipmentTypeId}"/>
                  <set field="priceTypeId" from-field="parameters.priceTypeId"/>
                   <set field="productCatageoryId" from-field="parameters.productCatageoryId"/>
                   <set field="vehicleId" from-field="parameters.vehicleId"/>
                <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/PurchaseEntryForm.groovy"/>
            </actions>
            <widgets>
                   <section>
               	  <!--  <condition>
               			<and>                     		
          					<if-has-permission permission="BYPRODUCTS" action="_INDENT"/>
              					<not><if-empty field="booth"/></not>
               			</and>
               		</condition> --> 
                       	<widgets>
                       	    <platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/PurchaseOrder.ftl"/></html></platform-specific>
                           </widgets>
                       <fail-widgets>
                           <platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/PurchaseOrder.ftl"/></html></platform-specific>								                           
                       </fail-widgets>
                   </section>
            </widgets>
        </section>
    </screen> 
    <screen name="FindInterUnitPurchase">
        <section>
            <actions>
                <set field="titleProperty" value="Find InterUnit Purchase Order"/>              
			    <set field="tabButtonItem" value="FindInterUnitPurchase" />	
			   <set field="tabButtonItem2" value="FindInterUnitPurchase"/>       
               <set field="headerItem" value="byProductsOrderEntry"/>
               <set field="viewSize" from-field="parameters.VIEW_SIZE"/>
               <set field="targetRequest" value="FindInterUnitPurchase"/>
               
                <set field="ChannalType" value="INTER_PRCHSE_CHANNEL"/> 
            </actions>
            <widgets>
                 <decorator-screen name="materialmgmtCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">  
                         <include-menu name="InterUnitPurchasesTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <section>
                            <widgets>
                                <decorator-screen name="FindScreenDecorator" location="component://common/widget/CommonScreens.xml">
                                    <decorator-section name="search-options">
                            			<include-form name="FindPurchaseOrder" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                      				</decorator-section>
                      				<decorator-section name="search-results">
                      					<screenlet title="">
                      						<!-- <link target="parlourSalesOrders.csv" text="Export As CSV" style="buttontext create">
									  	 		<parameter param-name="orderId" from-field="parameters.orderId"/>
												<parameter param-name="hideSearch" from-field="parameters.hideSearch"/>
												<parameter param-name="orderDate" from-field="parameters.orderDate"/>
												<parameter param-name="orderType" from-field="parameters.orderType"/>
												<parameter param-name="salesChannelEnumId" from-field="parameters.salesChannelEnumId"/>
												<parameter param-name="statusId" from-field="parameters.statusId"/>
												<parameter param-name="productStoreId" from-field="parameters.productStoreId"/>
												<parameter param-name="noConditionFind" from-field="parameters.noConditionFind"/>
									  	 	</link> -->
                          					<include-form name="listPurchaseOrders" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                      					</screenlet>
                      				</decorator-section>
                                </decorator-screen>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>            
        </section>
    </screen> 
    <screen name="InterUnitPurchaseOrderInit">
        <section>
            <actions>
               <set field="titleProperty" value="InterUnit Purchase Order Entry"/>              
			   <set field="tabButtonItem" value="FindInterUnitPurchase" />	
			   <set field="tabButtonItem2" value="InterUnitPurchaseOrderInit"/>  
			    <set field="changeFlag" value="InterUnitPurchase"/>  
               <set field="priceTypeId" from-field="parameters.priceTypeId"/>
               <set field="orderStatus" from-field="parameters.orderStatus"/> 
               <set field="orderId" from-field="parameters.orderId"/>
               <set field="supplyDate" from-field="parameters.supplyDate"/>
                <set field="isFormSubmitted" from-field="parameters.isFormSubmitted"/>
               <set field="defaultEffectiveDateTime" value="${supplyDate}" default-value="${bsh:org.ofbiz.base.util.UtilDateTime.nowTimestamp()}"/>
			   <set field="defaultEffectiveDate" 
					value="${groovy:org.ofbiz.base.util.UtilDateTime.toDateString(defaultEffectiveDateTime, &quot;dd MMMMM, yyyy&quot;);}" />	
				 <!--  <set field="parameters.roleTypeId" value="MAINSTORE_VENDOR"/> -->
				   <set field="parameters.roleTypeId" value="UNITS"/> 
            </actions>
            <widgets>
              <decorator-screen name="materialmgmtCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">   
                      <include-menu name="InterUnitPurchasesTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                      	<section>
	                      	  <condition>
	                             <if-compare operator="equals" field="isFormSubmitted" value=""/>
	                         </condition>
	                      		<widgets>
	           						<include-screen name="PurchaseOrderInner"/>
	                      		</widgets>
                      	</section>
                      <section>
                      <condition>
                      <if-compare operator="equals" field="isFormSubmitted" value="YES"/>
                      </condition>
                                <widgets>
	           						 <include-screen name="PurchaseOrderEntry"/>
	                      		</widgets>
                      </section>
                    </decorator-section>                                       
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="StockPosition">
        <section>
            <actions>
                <property-map resource="OrderUiLabels" map-name="uiLabelMap" global="true"/>
                 <property-map resource="ProductUiLabels" map-name="uiLabelMap" global="true"/>
                <set field="titleProperty" value="StockPosition"/>              
			    <set field="tabButtonItem" value="stockPosition" />	
			   <set field="tabButtonItem2" value="stockPosition"/>       
               <set field="headerItem" value="StockPosition"/>
               <set field="ajaxUrl" value="StockPositionInternal" type="String"/>
            </actions>
            <widgets>
                 <decorator-screen name="CommonInventoryDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body"> 
                      	<include-menu name="stockPositionSubTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>  
                        <section>
                            <widgets>
                               <platform-specific> 
                            		<html><html-template location="component://materialmgmt/webapp/materialmgmt/reports/stockPosition_Select.ftl"/></html>
                        		</platform-specific>  
                        		<include-screen name="StockPositionInternal"/>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>            
        </section>
    </screen> 
     <screen name="StockPositionInternal">
        <section>
            <actions>
                 <property-map resource="OrderUiLabels" map-name="uiLabelMap" global="true"/>
                  <property-map resource="ProductUiLabels" map-name="uiLabelMap" global="true"/>
                  <property-map resource="CommonUiLabels" map-name="uiLabelMap" global="true"/>
				<script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/reports/stockPosition.groovy"/>  
            </actions>  
               <condition> <or>
               		<not><if-empty field="parameters.productId"/></not>
               		<not><if-empty field="productId"/></not>
               </or>
            	</condition> 
            <widgets>
                  	<container>
	                  	    <platform-specific> 
	                            		<html><html-template location="component://materialmgmt/webapp/materialmgmt/reports/stockPosition.ftl"/></html>
	                        </platform-specific>
                       
                         <!--  <platform-specific>
		                         <html><html-template location="component://materialmgmt/webapp/materialmgmt/reports/ProductInventorySummary.ftl"/></html>
		                   </platform-specific>
	                     -->
	                   
                      <platform-specific>
	                         <html><html-template location="component://materialmgmt/webapp/materialmgmt/reports/EditProductInventoryItems.ftl"/></html>
	                     </platform-specific>
	                   
	                     <screenlet title="${uiLabelMap.ProductOutstandingPurchaseOrders}">
	                         <include-form name="OutstandingPurchaseOrders" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
	                     </screenlet>
	                     <screenlet title="${uiLabelMap.ProductRequirements}">
	                         <include-form name="ListRequirements" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
	                     </screenlet>
	                     <screenlet title="${uiLabelMap.Indents}">
	                         <include-form name="ListRequestList" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
	                     </screenlet>
	                     <screenlet title="${uiLabelMap.ProductSuppliers}">
	                         <include-form name="ListSupplierProducts" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
	                     </screenlet>
                  	</container>   
            </widgets>
        </section>
    </screen> 
    <screen name="PurchageOrderOverView">
           	<section>
           		<actions>
           			<set field="titleProperty" value="Purchase Order OverView - OrderId - ${parameters.orderId}"/> 
           			<set field="tabButtonItem" value="FindMaterialPO" />	
       			      <set field="tabButtonItem2" value="POoverView"/> 
                       <set field="layoutSettings.javaScripts[]" value="/ordermgr/images/js/order.js" global="true"/>
                       <set field="layoutSettings.javaScripts[]" value="/ordermgr/images/js/OrderShippingInfo.js" global="true"/>
                       <set field="layoutSettings.javaScripts[]" value="/ordermgr/images/js/geoAutoCompleter.js" global="true"/>
                       <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/PurchageOrderView.groovy"/>
                       <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/POViewWebSecure.groovy"/>
                   </actions>
       	    	<widgets>
       	            <decorator-screen name="POOverViewDecorator" location="${parameters.mainDecoratorLocation}">
       	            	<decorator-section name="body"> 
       	            	<include-menu name="FindMaterialPOSubTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
       	            		<section>
       	            			<widgets>
       	            				<container style="lefthalf" >
       		            				<platform-specific>
       	                    				<html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/PurchageOrderInfo.ftl"/></html>
       	                				</platform-specific>
       	                				<platform-specific>
       	                            			<html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/POItems.ftl"/></html>
       	                        		</platform-specific>
       	                        		<platform-specific>
       	                            		<html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/POterms.ftl"/></html>
       	                        		</platform-specific>
       	                        		<platform-specific>
       	                            		<html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/POSuspend.ftl"/></html>
       	                        		</platform-specific>
       	                        		<screenlet title="Order Amendments">
       	                        			<include-form location="component://materialmgmt/widget/MaterialPurchaseForms.xml" name="orderAmendments"/>
       	                        		</screenlet>
       	                        		<screenlet title="Order Attributes">
       	                        			<include-screen name="orderAttributes"/>
       	                        		</screenlet>
       	                        		<include-screen name="orderAssoc"/>
                       				</container>
                       				<container style="righthalf" >
       	                        		<platform-specific>
                           					<html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/POContactInfo.ftl"/></html>
                       					</platform-specific>
       	                        		<screenlet title="Receipts For Order">
       					                 	<!-- <include-form location="component://materialmgmt/widget/MaterialPurchaseForms.xml" name="listMaterialShipmentReceipt"/> -->
       					                 	<include-screen name="listMaterialShipmentReceipt"/>
       					                </screenlet>
       					                <platform-specific>
                           					<html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/POpaymentInfo.ftl"/></html>
                       					</platform-specific>
                       					 <screenlet title="Invoices For Order">
       					                 	<include-form location="component://materialmgmt/widget/MaterialPurchaseForms.xml" name="invoiceDetailList"/>
       					                </screenlet>
       					                <screenlet title="Content">
       					                <include-screen name="POcontent"/>
       					                </screenlet>
       					                <platform-specific>
                                   			<html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/PONotes.ftl"/></html>
                               			</platform-specific>
                               			 <screenlet title="Supply Products Till Date">
                                        	<include-screen name="supplyProductsTillDate"/>                              			 
       					                </screenlet>
                       				</container>
       	            			</widgets>
       	            		</section>
       	                </decorator-section> 
       	    		</decorator-screen>
       	    	</widgets>
           	</section>
    </screen>
    <screen name="OrderNewNote">
        <section>
            <actions>
            <set field="titleProperty" value="Create New Note"/> 
            <set field="tabButtonItem" value="FindMaterialPO" />	
			      <set field="tabButtonItem2" value="FindMaterialPO"/> 
                <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/PONewNote.groovy"/>
            </actions>
            <widgets>
            <decorator-screen name="POOverViewDecorator" location="${parameters.mainDecoratorLocation}">
	            <decorator-section name="body"> 
                 <platform-specific>
                     <html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/PONewNote.ftl"/></html>
                 </platform-specific>
                </decorator-section>
            </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="POcontent">
    <section>
    	<actions>
                <property-map resource="CommonUiLabels" map-name="uiLabelMap" global="true"/>
                <property-map resource="ContentUiLabels" map-name="uiLabelMap" global="true"/>
                <entity-condition entity-name="OrderContentAndDataResource" list="orderContentList" filter-by-date="true">
                    <condition-list combine="and">
                        <condition-expr field-name="orderId" operator="equals"  from-field="parameters.orderId"/>
                        <condition-expr field-name="contentTypeId" operator="equals"  value="PO_DOCUMENT"/>
                        <condition-expr field-name="dataCategoryId" operator="equals"  value="PO_DOCUMENT"/>
                        <!-- <condition-expr field-name="isPublic" operator="equals" value="Y"/> -->
                    </condition-list>
                    <order-by field-name="-createdDate"/>
                </entity-condition>   
    	</actions>
    	<widgets>
    		<include-form location="component://materialmgmt/widget/MaterialPurchaseForms.xml" name="UploadPOcontent"/>
    		<include-form location="component://materialmgmt/widget/MaterialPurchaseForms.xml" name="ListPOContent"/>
    	</widgets>
    </section>
    </screen>
    
    <screen name="searchMaterial">
    <section>
    	<actions>
    		<set field="titleProperty" value="Material Search"/>              
			<set field="tabButtonItem" value="searchMaterial" />
			<set field="tabButtonItem2" value="searchMaterial" />		
			<set field="entityName" value="Product"/>
         <!--<field position="2" name="quantityUomId" title="${uiLabelMap.ProductQuantityUomId}">
            <drop-down allow-empty="false">
                <entity-options key-field-name="uomId" description="${description} - ${abbreviation}" entity-name="Uom" >
                    <entity-constraint name="uomId" operator="in" value="VLIQ_ml,VLIQ_L"/>                                      
                    <entity-order-by field-name="description"/>
                </entity-options>
            </drop-down>
        </field>
         <field position="2" name="weightUomId" title="${uiLabelMap.ProductWeightUomId}">
            <drop-down allow-empty="true">
                <entity-options entity-name="Uom" key-field-name="uomId" description="${description} [${abbreviation}]">
                    <entity-constraint name="uomTypeId" value="WEIGHT_MEASURE"/>
                    <entity-order-by field-name="description"/>
                </entity-options>
            </drop-down>
        </field> -->
            <entity-condition entity-name="Uom" list="uomList" >
             <condition-list combine="and">
                        <condition-expr field-name="uomTypeId"  operator="not-equals"  value="CURRENCY_MEASURE"  />
                    </condition-list>
                    <order-by field-name="description"/>
             </entity-condition> 
            <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/materialUpdateUomIds.groovy"/>
    	</actions>
    	<widgets>
    		<decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
            	<decorator-section name="body">
            	<include-menu name="createNewVendor" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
            	<platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/editMaterialDetails.ftl"/></html></platform-specific>
            	<section>
            		<condition>
            			<if-has-permission permission="MM" action="_ADD_MATERIAL"/>
            		</condition>
    					<widgets>
                			<link target="AddMaterial" text="Add Material" style="buttontext"/>
   	     				</widgets>
   	     		</section>
            	<screenlet title="Search-Options">
            		<include-form location="component://materialmgmt/widget/materialmgmtForms.xml" name="findMaterial"/>
            	</screenlet>
            	<screenlet title="Search-Results">
            		<include-form location="component://materialmgmt/widget/materialmgmtForms.xml" name="listMaterial"/>
            	</screenlet>
            	</decorator-section>
            </decorator-screen>
    	</widgets>
    </section>
    </screen>
    <screen name="AddMaterial">
        <section>
            <actions>
                <set field="titleProperty" value="Add Material"/>              
			    <set field="tabButtonItem" value="searchMaterial" />	
               <set field="targetRequest" value="addMaterial"/>
                <!-- <set field="ChannalType" value="PROD_PRCHSE_CHANNEL"/>  -->
                <script location="component://byproducts/webapp/byproducts/WEB-INF/actions/facility/enablePartyAutoComplete.groovy"/>
                 <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/ProductEntryFormNew.groovy"/>
            </actions>
            <widgets>
                 <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">  
                        <section>
                            <widgets>
                               <label style="h1">Material Details</label>
                               <platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/AddMaterial.ftl"/></html></platform-specific>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>            
        </section>
    </screen>
    <screen name="orderAttributes">
    	<section>
    	<actions>
    	<entity-and entity-name="OrderAttribute" list="OrderAttributeList">
    		<field-map field-name="orderId" from-field="parameters.orderId"/>
    	</entity-and>
    	</actions>
			<widgets>
				<include-form location="component://materialmgmt/widget/materialmgmtForms.xml" name="addAttribute"/>
				<screenlet >
				<include-form location="component://materialmgmt/widget/materialmgmtForms.xml" name="listAttribute"/>
				</screenlet>
			</widgets>    	
    	</section>
    </screen>
    <screen name="listMaterialShipmentReceipt">
    	<section>
    	<actions>
    	<set field="viewIndex" from-field="parameters.VIEW_INDEX" type="Integer"/>
                <set field="viewSize" from-field="parameters.VIEW_SIZE" type="Integer" default-value="20"/>
               <set field="targetRequest" value="FindGRNReceipts"/>
             <service service-name="performFind" result-map="result" result-map-list="listIt">
                <field-map field-name="inputFields" from-field="parameters"/>
                <field-map field-name="entityName" value="ShipmentReceipt"/>
                <field-map field-name="orderBy"  value="-receiptId"/>
                <field-map field-name="viewIndex" from-field="viewIndex"/>
                <field-map field-name="viewSize" from-field="viewSize"/>
            </service>
               <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/purchaseDepartments.groovy"/>
               <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/SupplyTillDate.groovy"/>
    	</actions>
			<widgets>
		  			<include-form name="listMaterialShipmentReceipt" location="component://materialmgmt/widget/MaterialPurchaseForms.xml"/>
					<platform-specific>
		                   <html>
						  <html-template location="component://materialmgmt/webapp/materialmgmt/purchase/qcApproval.ftl"/>
					   </html>
				   </platform-specific>				   
			</widgets>    	
    	</section>
    </screen>
    <screen name="supplyProductsTillDate">
    	<section>
    	<actions>
    	<set field="viewIndex" from-field="parameters.VIEW_INDEX" type="Integer"/>
                <set field="viewSize" from-field="parameters.VIEW_SIZE" type="Integer" default-value="20"/>
               <set field="targetRequest" value="FindGRNReceipts"/>
             <service service-name="performFind" result-map="result" result-map-list="listIt">
                <field-map field-name="inputFields" from-field="parameters"/>
                <field-map field-name="entityName" value="ShipmentReceipt"/>
                <field-map field-name="orderBy"  value="-receiptId"/>
                <field-map field-name="viewIndex" from-field="viewIndex"/>
                <field-map field-name="viewSize" from-field="viewSize"/>
            </service>
          <!--       <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/purchaseDepartments.groovy"/> -->
               <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/SupplyTillDate.groovy"/>
    	</actions>
			<widgets>
		  			<include-form name="supplyProductstilldate" location="component://materialmgmt/widget/MaterialPurchaseForms.xml"/>
					
			</widgets>    	
    	</section>
    </screen>
    <screen name="orderAssoc">
    	<section>
    	<actions>
    	<entity-condition list="OrderAssocList" entity-name="OrderAssoc">
    		<condition-list combine="or"> 
	    		<condition-expr field-name="orderId" from-field="parameters.orderId"/>
	    		<condition-expr field-name="toOrderId" from-field="parameters.orderId"/>
    		</condition-list>
    	</entity-condition>
    	<set field="assocId" value="${parameters.orderId}"/>
    	</actions>
			<widgets>
				<screenlet title="Order Associations" >
				<include-form location="component://materialmgmt/widget/materialmgmtForms.xml" name="listOrderAssoc"/>
				</screenlet>
			</widgets>    	
    	</section>
    </screen>
    <screen name="MaterialConsumption">
        <section>
            <actions>
                <property-map resource="OrderUiLabels" map-name="uiLabelMap" global="true"/>
                 <property-map resource="ProductUiLabels" map-name="uiLabelMap" global="true"/>
                <set field="titleProperty" value="MaterialConsumption"/>              
			    <set field="tabButtonItem" value="stockPosition" />	
			   <set field="tabButtonItem2" value="MaterialConsumption"/>       
               <set field="headerItem" value="StockPosition"/>
               <set field="ajaxUrl" value="MaterialConsumptionInternal" type="String"/>
               <entity-and list="internalOrgList" entity-name="PartyRoleAndPartyDetail">
                   <field-map field-name="roleTypeId" value="INTERNAL_ORGANIZATIO"/>
                   <select-field field-name="partyId"/>
                   <select-field field-name="groupName"/>
               </entity-and>
               <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/purchaseDepartments.groovy"/>
            </actions>
            <widgets>
                 <decorator-screen name="CommonInventoryDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body"> 
                      	 <include-menu name="stockPositionSubTabBar" location="component://materialmgmt/widget/materialmgmtMenus.xml"/> 
                        <section>
                            <widgets>
                               <platform-specific> 
                            		<html><html-template location="component://materialmgmt/webapp/materialmgmt/reports/materialConsumption_Select.ftl"/></html>
                        		</platform-specific>  
                        		<include-screen name="MaterialConsumptionInternal"/>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>            
        </section>
    </screen> 
     <screen name="MaterialConsumptionInternal">
        <section>
            <actions>
                 <property-map resource="OrderUiLabels" map-name="uiLabelMap" global="true"/>
                  <property-map resource="ProductUiLabels" map-name="uiLabelMap" global="true"/>
                  <property-map resource="CommonUiLabels" map-name="uiLabelMap" global="true"/>
                  <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/reports/stockPosition.groovy"/> 
				<script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/reports/MaterialConsumptionPattern.groovy"/>  
            </actions>  
               <condition> <or>
               		<not><if-empty field="parameters.productId"/></not>
               		<not><if-empty field="productId"/></not>
               </or>
            	</condition> 
            <widgets>
                  	<container>
	                  	    <platform-specific> 
	                            <html><html-template location="component://materialmgmt/webapp/materialmgmt/reports/materialConsumptionPattern.ftl"/></html>
	                        </platform-specific>
                  	</container>   
            </widgets>
        </section>
    </screen>
         <screen name="FGSProductSaleMm">
        <section>
            <actions>
               <set field="titleProperty" value="Sale"/>              
			   <set field="tabButtonItem" value="FGSProductSaleMm" />	
			   <set field="tabButtonItem2" value="FGSProductSaleMm"/>  
			    <set field="changeFlag" value="FgsSales"/>  
               <set field="priceTypeId" from-field="parameters.priceTypeId"/>
               <set field="orderStatus" from-field="parameters.orderStatus"/> 
               <set field="orderId" from-field="parameters.orderId"/>
               <set field="supplyDate" from-field="parameters.supplyDate"/>
                <set field="isFormSubmitted" from-field="parameters.isFormSubmitted"/>
               <set field="defaultEffectiveDateTime" value="${supplyDate}" default-value="${bsh:org.ofbiz.base.util.UtilDateTime.nowTimestamp()}"/>
			   <set field="defaultEffectiveDate" 
					value="${groovy:org.ofbiz.base.util.UtilDateTime.toDateString(defaultEffectiveDateTime, &quot;dd MMMMM, yyyy&quot;);}" />	
				 <set field="parameters.roleTypeId" value="FGS_CUSTOMER"/>
				<!--  <set field="productCategoryResult" value="${groovy:org.ofbiz.product.product.ProductWorker.getProductsByCategoryAssoc(delegator, 'INDENT_PROD_CAT', 'FGS_INDENT', null)}" /> -->
				<!--  <set field="productStoreResult" value="${groovy:in.vasista.vbiz.byproducts.icp.ICPServices.getProductStoreByGroupId(delegator, 'FGS_SALE_STORE')}" />
				<set field="productStoreId" value="${productStoreResult.factoryStoreId}"/>
				<set field="prodCatalogIdResult" value="${groovy:org.ofbiz.product.catalog.CatalogWorker.getStoreCatalogs(delegator,productStoreId)}" />
			    <set field="prodCatalogIdResult" value="${prodCatalogIdResult.[0]get(&quot;prodCatalogId&quot;)}"/>
			   <set field="prodCatalogId" value="${prodCatalogIdResult[0].prodCatalogId}"/>
			   <set field="productCategoryListResult" value="${groovy:org.ofbiz.product.catalog.CatalogWorker.getProdCatalogCategories(delegator,prodCatalogId,null)}" />
			   <set field="productCategoryIdsList" value="${groovy:org.ofbiz.entity.util.EntityUtil.getFieldListFromEntityList(productCategoryListResult, 'productCategoryId', true);}" type="List"/>
	
			   <entity-condition entity-name="ProductCategory" list="productCategoryListResult" use-cache="true">
                	<condition-list>
                    	<condition-expr field-name="productCategoryId" operator="in"  from-field="productCategoryIdsList"/>
                    </condition-list>
                </entity-condition>
             
			  <set field="categoryList" from-field="productCategoryListResult"/> -->
				<!-- <set field="categoryList" value="${productCategoryResult.productCategory}"/> -->
				
			  <!--  <entity-condition entity-name="ProductStoreGroupMember" list="productStoreGroupMemberList" use-cache="true">
                	<condition-list >
                    	<condition-expr field-name="productStoreGroupId" operator="equals" value="FGS_SALE_STORE" />
                    </condition-list>
                </entity-condition> -->
            </actions>
            <widgets>
              <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">   
                      <include-menu name="FGSSaleTabBarMm" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                      	<section>
                      	
	                    	<condition>
	                        	<if-compare operator="equals" field="isFormSubmitted" value=""/>
	                        </condition>
                      		<widgets>
           						<include-screen name="AdhocSaleInnerMm"/>
                      		</widgets>
                      	</section>
                      <section>
                      <condition>
                      <if-compare operator="equals" field="isFormSubmitted" value="YES"/>
                      </condition>
                          <widgets>
      						 <include-screen name="SalesInnerScreenMm"/>
                 		</widgets>
                      </section>
                    </decorator-section>                                       
                </decorator-screen>
            </widgets>
        </section>
    </screen>
     <screen name="ProcessFGSOrdersMm">
        <section>
            <actions>
                <set field="titleProperty" value="Process Union Orders"/>              
			    <set field="tabButtonItem" value="FGSProductSaleMm" />	
			   <set field="tabButtonItem2" value="ProcessFGSOrdersMm"/>       
               <set field="headerItem" value="byProductsOrderEntry"/>
               <set field="viewSize" from-field="parameters.VIEW_SIZE"/>
               <set field="defaultEffectiveDateTime" value="${bsh:org.ofbiz.base.util.UtilDateTime.getDayStart(org.ofbiz.base.util.UtilDateTime.nowTimestamp())}"/>
			    <set field="defaultEffectiveDate" 
					value="${groovy:org.ofbiz.base.util.UtilDateTime.toDateString(defaultEffectiveDateTime, &quot;dd MMMMM, yyyy&quot;);}" />
               <set field="shipmentTypeId" from-field="parameters.shipmentTypeId"/>
               <set field="salesChannelEnumId" from-field="parameters.salesChannelEnumId" />
               <set field="screenFlag" value="fgsSales"/>
               <script	location="component://byproducts/webapp/byproducts/WEB-INF/actions/facility/getIcpSalesOrder.groovy" />
            </actions>
            <widgets>
              <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">  
                      <include-menu name="FGSSaleTabBarMm" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <section>
                            <widgets>
               					<screenlet title="FGS Orders">
               						<platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/ListSearchSaleOrdersMm.ftl"/></html></platform-specific>
               					</screenlet>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>            
        </section>
    </screen>
    <screen name="FindFGSShipmentMm">
        <section>
            <actions>
                <set field="titleProperty" value="Find Union Sale Shipments"/>              
			    <set field="tabButtonItem" value="FGSProductSaleMm" />	
			   <set field="tabButtonItem2" value="FindFGSShipmentMm"/>       
               <set field="viewSize" from-field="parameters.VIEW_SIZE"/>
               <set field="targetRequest" value="FindFGSShipmentMm"/>
               <set field="shipmentTypeId" value="FGS_SHIPMENT"/>
               <set field="screenFlag" value="fgsSales"/>
            </actions>
            <widgets>
              <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">  
                      <include-menu name="FGSSaleTabBarMm" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <section>
                            <widgets>
                                <decorator-screen name="FindScreenDecorator" location="component://common/widget/CommonScreens.xml">
                                    <decorator-section name="search-options">
			                            			<include-form name="FindICPShipmentMm" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                      				</decorator-section>
                      				<decorator-section name="search-results">
                      					<screenlet title="">
                      						<include-form name="listFGSShipmentsMm" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                      					</screenlet>
                      				</decorator-section>
                                </decorator-screen>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>            
        </section>
    </screen>
    <screen name="InterUnitStkTrMm">
        <section>
            <actions>
               <set field="titleProperty" value="Inter Unit Transfer"/>              
			   <set field="tabButtonItem" value="InterUnitStkTrMm" />	
			   <set field="tabButtonItem2" value="InterUnitStkTrMm"/>  
			    <set field="changeFlag" value="InterUnitTransferSale"/>  
               <set field="priceTypeId" from-field="parameters.priceTypeId"/>
               <set field="orderStatus" from-field="parameters.orderStatus"/> 
               <set field="orderId" from-field="parameters.orderId"/>
               <set field="orderFacility" from-field="parameters.orderFacility"/> 
               <set field="orderRoute" from-field="parameters.orderRoute"/> 
               <set field="supplyDate" from-field="parameters.supplyDate"/>
                <set field="isFormSubmitted" from-field="parameters.isFormSubmitted"/>
               <set field="defaultEffectiveDateTime" value="${supplyDate}" default-value="${bsh:org.ofbiz.base.util.UtilDateTime.nowTimestamp()}"/>
			   <set field="defaultEffectiveDate" 
					value="${groovy:org.ofbiz.base.util.UtilDateTime.toDateString(defaultEffectiveDateTime, &quot;dd MMMMM, yyyy&quot;);}" />
			   <set field="parameters.roleTypeId" value="UNITS"/>
			   <set field="productStoreResult"	value="${groovy:in.vasista.vbiz.byproducts.icp.ICPServices.getProductStoreByGroupId(delegator, 'FG_STORE')}" />
				<set field="productStoreId" value="${productStoreResult.factoryStoreId}"/>
				<set field="productCategoryResult" value="${groovy:org.ofbiz.product.product.ProductWorker.getProductsByCategoryAssoc(delegator, 'INDENT_PROD_CAT', 'FGS_INDENT', null)}" />
				 <set field="productStoreResult" value="${groovy:in.vasista.vbiz.byproducts.icp.ICPServices.getProductStoreByGroupId(delegator, 'FG_STORE')}" />
				<set field="categoryList" value="${productCategoryResult.productCategory}"/>		
			   					  					  
            </actions>
            <widgets>
              <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">   
                      <include-menu name="InterUnitTrTabBarMm" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                      	<section>
	                      	  <condition>
	                             <if-compare operator="equals" field="isFormSubmitted" value=""/>
	                         </condition>
	                      		<widgets>
	           						<include-screen name="AdhocSaleInnerMm"/>
	                      		</widgets>
                      	</section>
                      <section>
                      <condition>
                      <if-compare operator="equals" field="isFormSubmitted" value="YES"/>
                      </condition>
                         <widgets>
     						 <include-screen name="SalesInnerScreenMm"/>
                		</widgets>
                      </section>
                      
                    </decorator-section>                                       
                </decorator-screen>
            </widgets>
        </section>
    </screen>
     <screen name="ProcessInterUnitStkTrMm">
        <section>
            <actions>
                <set field="titleProperty" value="Inter Unit Transfer"/>              
			    <set field="tabButtonItem" value="InterUnitStkTrMm" />	
			   <set field="tabButtonItem2" value="ProcessInterUnitStkTrMm"/>       
               <set field="headerItem" value="OrderEntry"/>
               <set field="viewSize" from-field="parameters.VIEW_SIZE"/>
               <set field="defaultEffectiveDateTime" value="${bsh:org.ofbiz.base.util.UtilDateTime.getDayStart(org.ofbiz.base.util.UtilDateTime.nowTimestamp())}"/>
			    <set field="defaultEffectiveDate" 
					value="${groovy:org.ofbiz.base.util.UtilDateTime.toDateString(defaultEffectiveDateTime, &quot;dd MMMMM, yyyy&quot;);}" />
               <set field="shipmentTypeId" from-field="parameters.shipmentTypeId"/>
               <set field="salesChannelEnumId" from-field="parameters.salesChannelEnumId" />
               <set field="screenFlag" value="InterUnitTransferSale"/>
               <script	location="component://byproducts/webapp/byproducts/WEB-INF/actions/facility/getIcpSalesOrder.groovy" />
            </actions>
            <widgets>
              <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">  
                      <include-menu name="InterUnitTrTabBarMm" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <section>
                            <widgets>
               					<screenlet title="Inter Unit Transfer Orders">
               						<platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/ListSearchSaleOrdersMm.ftl"/></html></platform-specific>
               					</screenlet>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>            
        </section>
    </screen>
    <screen name="FindStockTranferShipmentMm">
        <section>
            <actions>
                <set field="titleProperty" value="Find Stock Transfer Shipment"/>              
			    <set field="tabButtonItem" value="InterUnitStkTrMm" />	
			   <set field="tabButtonItem2" value="FindStockTranferShipmentMm"/>       
               <set field="viewSize" from-field="parameters.VIEW_SIZE"/>
               <set field="targetRequest" value="FindStockTranferShipmentMm"/>
               <set field="shipmentTypeId" value="INTUNIT_TR_SHIPMENT"/> 
               <set field="screenFlag" value="InterUnitTransferSale"/> 
            </actions>
            <widgets>
              <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">  
                      <include-menu name="InterUnitTrTabBarMm" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <section>
                            <widgets>
                                <decorator-screen name="FindScreenDecorator" location="component://common/widget/CommonScreens.xml">
                                    <decorator-section name="search-options">
			                            			<include-form name="FindICPShipmentMm" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                      				</decorator-section>
                      				<decorator-section name="search-results">
                      					<screenlet title="Inter Unit Stock Transfrd Shipments">
                      						<include-form name="listInterUnitShipmentsMm" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                      					</screenlet>
                      				</decorator-section>
                                </decorator-screen>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>            
        </section>
    </screen>
     <screen name="AdhocSaleInnerMm">
        <section>
            <actions>
               <set field="changeFlag" from-field="changeFlag"/> 
               <set field="productSubscriptionTypeId" value="${parameters.productSubscriptionTypeId}"/>
               <set field="subscriptionTypeId" from-field="parameters.subscriptionTypeId"/>
               <entity-one value-field="showBoothAutoSuggestConf" entity-name="TenantConfiguration">
               		<field-map field-name="propertyTypeEnumId" value="FACILITY_AUTOSUGGEST"/>
               		<field-map field-name="propertyName" value="showBoothAutoSuggest"/>
               		<select-field field-name="propertyValue"/>
               </entity-one>
              
            
               <set field="showBoothAutoSuggest" value="${showBoothAutoSuggestConf.propertyValue}"/>
               <set field="supplyDate" from-field="parameters.supplyDate"/>
               <set field="effectiveDate" value="${parameters.effectiveDate}"/>
               <set field="checkListType" value="indentEntry"/>
               <set field="shipmentTypeId" value="${parameters.shipmentTypeId}"/>
                <entity-condition entity-name="Enumeration" list="prodSubTypes" use-cache="true">
                	<condition-list>
                    	<condition-expr field-name="enumTypeId" value="SUB_PROD_TYPE"/>  
                    	<condition-expr field-name="enumId" operator="not-equals" value="CARD"/> 
                    	 <condition-expr field-name="enumId" operator="not-equals" value="LEAK"/>  
                    </condition-list>
                    <order-by field-name="sequenceId"/>
                </entity-condition>
              
               <!--  <entity-condition entity-name="Product" list="productList" use-cache="true">
                </entity-condition> -->                
                <script location="component://byproducts/webapp/byproducts/WEB-INF/actions/recentChangeIndents.groovy"/>
              <!--   <script location="component://byproducts/webapp/byproducts/WEB-INF/actions/indentCheckListReport.groovy"/>  --> 
              <!--   <script location="component://byproducts/webapp/byproducts/WEB-INF/actions/facility/enableBoothAutoComplete.groovy"/> -->
                <script location="component://byproducts/webapp/byproducts/WEB-INF/actions/facility/enablePartyAutoComplete.groovy"/>
               <set field="routeId" from-field="parameters.routeId"/>            
            </actions>
            <widgets>
               	<section>
                 	 <widgets>
          					<platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/indentAdhocSaleMm.ftl"/></html></platform-specific>
                     </widgets>
                     <fail-widgets>
						<label style="h3">${uiLabelMap.ProductFacilityViewPermissionError}
						</label>
					</fail-widgets>
             	</section>                  
            </widgets>
        </section>
    </screen> 
    
     <screen name="SalesInnerScreenMm">
        <section>
            <actions>
            	<set field="changeFlag" from-field="changeFlag"/>  
               	<set field="productSubscriptionTypeId" from-field="parameters.productSubscriptionTypeId"/>
               	<set field="subscriptionTypeId" from-field="parameters.subscriptionTypeId"/> 
               	<set field="boothId" from-field="parameters.boothId"/>
                <!-- <entity-condition entity-name="Enumeration" list="prodSubTypes" use-cache="true">
                    <condition-expr field-name="enumTypeId" value="SUB_PROD_TYPE"/>
                    <order-by field-name="sequenceId"/>
                </entity-condition> -->
                <set field="checkListType" value="indentEntry"/>
                <set field="effectiveDate" value="${parameters.effectiveDate}"/>
                <set field="shipmentTypeId" value="${parameters.shipmentTypeId}"/>
                <set field="priceTypeId" from-field="parameters.priceTypeId"/>
                <set field="PONumber" from-field="parameters.PONumber"/>
                <set field="promotionAdj" from-field="parameters.promotionAdj"/>
                <set field="productCategoryId" from-field="parameters.productCategoryId"/>
                <set field="vehicleId" from-field="parameters.vehicleId"/>
                 <set field="productStoreId" from-field="parameters.productStoreIdFrom"/>
                <script location="component://byproducts/webapp/byproducts/WEB-INF/actions/facility/AdhocIndentForm.groovy"/>
                <script location="component://byproducts/webapp/byproducts/WEB-INF/actions/facility/EditStoreOrderForm.groovy"/>
              <!--   <script location="component://byproducts/webapp/byproducts/WEB-INF/actions/recentChangeIndents.groovy"/>   -->              
               <!--  <script location="component://byproducts/webapp/byproducts/WEB-INF/actions/indentCheckListReport.groovy"/>    -->             
            </actions>
            <widgets>
                   <section>
               	   <condition>
               			<and>                     		
          					<if-has-permission permission="BYPRODUCTS" action="_INDENT"/>
              					<not><if-empty field="booth"/></not>
               			</and>
               		</condition> 
                       	<widgets>
                       	    <platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/indentAdhocSaleMm.ftl"/></html></platform-specific>
                        </widgets>
                       <fail-widgets>
                           <platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/indentAdhocSaleMm.ftl"/></html></platform-specific>								                           
                       </fail-widgets>
                   </section>
            </widgets>
        </section>
    </screen>
    <!-- Party Find Screen -->
    <screen name="findVendor">
        <section>
            <actions>
                <property-map resource="PartyUiLabels" map-name="uiLabelMap" global="true"/>
                <property-map resource="VendorUiLabels" map-name="uiLabelMap" global="true"/>
                <set field="titleProperty" value="FindVendor"/>
                <set field="headerItem" value="find"/>
                <set field="tabButtonItem" value="searchMaterial"/>
                <set field="tabButtonItem2" value="findVendor"/>
				<set field="layoutSettings.javaScripts[]" value="/materialmgmt/images/VendorValidations.js" global="true" />
                <service service-name="findParty" auto-field-map="parameters"/>
            </actions>
            <widgets>
                <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">   
                      <include-menu name="createNewVendor" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                      	<section>
	                      	  <condition>
	                             <if-compare operator="equals" field="isFormSubmitted" value=""/>
	                         </condition>
	                            
                    	         
                    	        
	                      		<widgets>
	                      		<link target="createNewVendor"  text="Create Vendor" style="buttontext" ></link>
	           						<platform-specific>
                                    <html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/findVendor.ftl"/></html>
                                </platform-specific>
	                      		</widgets>
	                      		 <fail-widgets>
                                <label style="h3" text="${uiLabelMap.PartyMgrViewPermissionError}"/>
                            </fail-widgets>
                      	</section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="editcontactmech">
        <section>
            <actions>
                <property-map resource="PartyUiLabels" map-name="uiLabelMap" global="true"/>
                <property-map resource="VendorUiLabels" map-name="uiLabelMap" global="true"/>
                <set field="titleProperty" value="PageTitleEditContactMech"/>
                <set field="headerItem" value="find"/>
                <set field="tabButtonItem" value="editcontactmech"/>
                <set field="tabButtonItem2" value="findVendor"/>
                <set field="labelTitleProperty" value="PageTitleEditContactMech"/>
				<set field="donePage" from-field="parameters.DONE_PAGE" default-value="viewprofile"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/HasPartyPermissions.groovy"/>
                <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/EditContactMech.groovy"/>
             </actions>
            <widgets>
                <decorator-screen name="main-decorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                     <include-menu name="createNewVendor" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <section>
                            <condition>
                                <or>
                                    <if-compare field="hasViewPermission" operator="equals" value="true" type="Boolean"/>
                                    <if-compare field="hasPcmCreatePermission" operator="equals" value="true" type="Boolean"/>
                                    <if-compare field="hasPcmUpdatePermission" operator="equals" value="true" type="Boolean"/>
                                    <if-compare-field field="parameters.partyId" operator="equals" to-field="userLogin.partyId"/>
                                    <not><if-empty field="mechMap.partyContactMech"/></not>
                                </or>
                            </condition>
                            <actions>
                                <!-- fields for setDependentDropdownValuesJs.ftl, it's a try on generalization but there are still issues. For instance: what if we have 2 couple of dependent dropdowns in the same form? -->
                                <set field="dependentForm" value="editcontactmechform"/>
                                <set field="paramKey" value="countryGeoId"/>                                        
                                <set field="mainId" value="countryId"/>
                                <set field="dependentId" value="stateId"/>
                                <set field="requestName" value="getAssociatedStateList"/>
                                <set field="responseName" value="stateList"/>
                                <set field="dependentKeyName" value="geoId"/>
                                <set field="descName" value="geoName"/>
                                <set field="selectedDependentOption" value="_none_"/>
                                   
                            </actions>
                            <widgets>
                                <platform-specific>
                                	<html><html-template location="component://common/webcommon/includes/setDependentDropdownValuesJs.ftl"/>
                               		<html-template location="component://materialmgmt/webapp/materialmgmt/purchase/editcontactmech.ftl"/></html>
                                </platform-specific>
                            </widgets>
                            <fail-widgets>
                                <container style="button-bar">
                                    <link target="backHome" text="[${uiLabelMap.CommonBack}]" style="smallSubmit"/>
                                </container>
                                <container>
                                    <label style="h3">${uiLabelMap.PartyMsgContactNotBelongToYou}</label>
                                </container>
                            </fail-widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="EditVendor">
        <section>
            <actions>
                <property-map resource="VendorUiLabels" map-name="uiLabelMap" global="true"/>
                <set field="titleProperty" value="PageTitleEditGroupInformation"/>
                <set field="tabButtonItem" value="searchMaterial"/>
                <set field="tabButtonItem2" value="findVendor"/>
                <set field="headerItem" value="find"/>
                <set field="labelTitleProperty" value="PageTitleEditGroupInformation"/>
                <set field="donePage" from-field="parameters.DONE_PAGE" default-value="viewprofile"/>
                <set field="partyId" from-field="parameters.partyId"/>
                <set field="layoutSettings.javaScripts[]" value="/materialmgmt/images/VendorValidations.js" global="true" />
                <entity-one entity-name="PartyAndGroup" value-field="partyGroup"/>
            </actions>
            <widgets>
               <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">   
                      <include-menu name="createNewVendor" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <screenlet title="${uiLabelMap.PageTitleEditGroupInformation}">
                            <include-form name="EditVendor" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="createNewVendor">
        <section>
            <actions>
                <property-map resource="VendorUiLabels" map-name="uiLabelMap" global="true"/>
                <set field="titleProperty" value="PageTitleEditGroupInformation"/>
                <set field="tabButtonItem" value="searchMaterial"/>
                <set field="tabButtonItem2" value="findVendor"/>
                <set field="headerItem" value="find"/>
                <set field="labelTitleProperty" value="PageTitleEditGroupInformation"/>
                <set field="donePage" from-field="parameters.DONE_PAGE" default-value="viewprofile"/>
                <set field="partyId" from-field="parameters.partyId"/>
                <set field="layoutSettings.javaScripts[]" value="/materialmgmt/images/VendorValidations.js" global="true" />
                <entity-one entity-name="PartyAndGroup" value-field="partyGroup"/>
            </actions>
            <widgets>
               <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">   
                      <include-menu name="createNewVendor" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
          					<platform-specific><html><html-template location="component://materialmgmt/webapp/materialmgmt/purchase/CreateVendor.ftl"/></html></platform-specific>
                        <!-- <screenlet title="${uiLabelMap.PageTitleEditGroupInformation}">
                            <include-form name="EditPartyGroup" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                        </screenlet>-->
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="viewprofile">
        <section>
            <actions>
              <property-map resource="PartyUiLabels" map-name="uiLabelMap" global="true"/>
              <property-map resource="VendorUiLabels" map-name="uiLabelMap" global="true"/>
                <set field="titleProperty" value="PageTitleViewPartyProfile"/>
                <set field="tabButtonItem" value="findVendor"/>
                <set field="tabButtonItem2" value="findVendor"/>
                <set field="donePage" from-field="parameters.DONE_PAGE" default-value="viewprofile"/>
                <set field="partyId" from-field="parameters.partyId"/>
                <set field="layoutSettings.javaScripts[]" value="/partymgr/js/PartyProfileContent.js" global="true"/>
                <script location="component://materialmgmt/webapp/materialmgmt/WEB-INF/actions/purchases/ViewProfile.groovy"/>
            </actions>
            <widgets>
                 <decorator-screen name="materialmgmtNgCommonDecorator" location="${parameters.mainDecoratorLocation}">
                      <decorator-section name="body">   
                      <include-menu name="createNewVendor" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                        <section>
                            <condition>
                                <and>
                                    <if-empty field="partyId"/>
                                    <not><if-empty field="parameters.telno"/></not>
                                </and>
                            </condition>
                            <actions>
                                <service service-name="findPartyFromTelephone" auto-field-map="true" result-map="telnoMap"/>
                                <entity-one entity-name="Party" value-field="party">
                                    <field-map field-name="partyId" from-field="telnoMap.partyId"/>
                                </entity-one>
                                <set field="parameters.partyId" from-field="party.partyId"/>
                            </actions>
                            <widgets/>
                        </section>
                        <section>
                            <condition>
                                <and>
                                    <if-empty field="partyId"/>
                                    <not><if-empty field="parameters.email"/></not>
                                </and>
                            </condition>
                            <actions>
                                <service service-name="findPartyFromEmailAddress" result-map="emailMap">
                                    <field-map field-name="address" from-field="parameters.email"/>
                                </service>
                                <entity-one entity-name="Party" value-field="party">
                                    <field-map field-name="partyId" from-field="emailMap.partyId"/>
                                </entity-one>
                                <set field="parameters.partyId" from-field="party.partyId"/>
                            </actions>
                            <widgets/>
                        </section>
                        <section>
                            <condition>
                                <not><if-empty field="party"/></not>
                            </condition>
                            <widgets>
                            	 <container>
                                    <include-screen name="Vendor"/>
                                    <include-screen name="Contact" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                      				<include-form name="EditVendorIdentification" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                      				<include-form name="createVendorIdentification" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                                </container>
                            </widgets>
                            <fail-widgets>
                                <container>
                                    <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                                </container>
                            </fail-widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
  <screen name="Vendor">
        <section>
            <actions>
                <property-map resource="VendorUiLabels" map-name="uiLabelMap" global="true"/>
                <set field="parameters.partyId" from-field="parameters.partyId" default-value="${userLogin.partyId}"/>
                <entity-and entity-name="PartyNameHistory" list="partyNameHistoryList">
                    <field-map field-name="partyId" from-field="parameters.partyId"/>
                    <order-by field-name="-changeDate"/>
                </entity-and>
                <entity-one entity-name="PartyAndGroup" value-field="lookupGroup">
                    <field-map field-name="partyId" from-field="parameters.partyId"/><!-- is required -->
                </entity-one>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="lookupGroup"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <screenlet title="${uiLabelMap.GroupInformation}" navigation-menu-name="groupUpdate" id="PartyGroupInformationPanel">
                                    <include-menu name="groupUpdate" location="component://materialmgmt/widget/materialmgmtMenus.xml"/>
                                    <include-form name="ViewVendor" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                                    <section>
                                        <condition>
                                            <not><if-empty field="partyNameHistoryList"/></not>
                                        </condition>
                                        <widgets>
                                            <include-form name="ViewVendorHistory" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                                        </widgets>
                                    </section>
                                </screenlet>
                            </widgets>
                            <fail-widgets>
                                <screenlet title="${uiLabelMap.GroupInformation}" id="PartyGroupInformationPanel">
                                    <include-form name="ViewVendor" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                                    <section>
                                        <condition>
                                            <not><if-empty field="partyNameHistoryList"/></not>
                                        </condition>
                                        <widgets>
                                            <include-form name="ViewVendorHistory" location="component://materialmgmt/widget/materialmgmtForms.xml"/>
                                        </widgets>
                                    </section>
                                </screenlet>
                            </fail-widgets>
                        </section>
                    </widgets>
                </section>
            </widgets>
        </section>
    </screen>
</screens>